
% Default to the notebook output style

    


% Inherit from the specified cell style.




    
\documentclass[11pt]{article}

    
    
    \usepackage[T1]{fontenc}
    % Nicer default font (+ math font) than Computer Modern for most use cases
    \usepackage{mathpazo}

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % We will generate all images so they have a width \maxwidth. This means
    % that they will get their normal width if they fit onto the page, but
    % are scaled down if they would overflow the margins.
    \makeatletter
    \def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
    \else\Gin@nat@width\fi}
    \makeatother
    \let\Oldincludegraphics\includegraphics
    % Set max figure width to be 80% of text width, for now hardcoded.
    \renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=.8\maxwidth]{#1}}
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionLabelFormat{nolabel}{}
    \captionsetup{labelformat=nolabel}

    \usepackage{adjustbox} % Used to constrain images to a maximum size 
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    

    
    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatability definitions
    \def\gt{>}
    \def\lt{<}
    % Document parameters
    \title{Bike\_Share\_Analysis-zh}
    
    
    

    % Pygments definitions
    
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % Exact colors from NB
    \definecolor{incolor}{rgb}{0.0, 0.0, 0.5}
    \definecolor{outcolor}{rgb}{0.545, 0.0, 0.0}



    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

    \begin{document}
    
    
    \maketitle
    
    

    
    \section{2016年美国共享单车活动快照}\label{ux5e74ux7f8eux56fdux5171ux4eabux5355ux8f66ux6d3bux52a8ux5febux7167}

\subsection{目录}\label{ux76eeux5f55}

\begin{itemize}
\tightlist
\item
  Section \ref{intro}
\item
  Section \ref{pose_questions}
\item
  Section \ref{wrangling}
\item
  Section \ref{condensing}
\item
  Section \ref{eda}
\item
  Section \ref{statistics}
\item
  Section \ref{visualizations}
\item
  Section \ref{eda_continued}
\item
  Section \ref{conclusions}
\end{itemize}

 \#\# 简介

\begin{quote}
\textbf{小贴士}:
像这样的引用部分旨在为学员提供实用指导，帮助学员了解并使用 Jupyter
notebook
\end{quote}

过去十年里，世界各城市的共享单车系统不仅不断增多，也越来越受人们欢迎。用户可借助共享单车系统来租赁单车，进行通常在
30
分钟以内的短途骑行。由于信息科技的崛起，用户能够方便地找到所用系统的停车点，实现单车解锁或归还操作。不仅如此，信息科技还带来了大量数据，有了这些数据，我们就能研究共享单车系统的使用情况。

在本项目中，你将进行探索性数据分析。你所需分析的数据源自
\href{https://www.motivateco.com/}{Motivate}，这是一家为美国诸多大城市提供共享单车系统的供应商。你将比较三大城市：纽约市、芝加哥和华盛顿特区的系统使用情况，并观察每个系统的长期注册用户和短期临时用户之间有无区别。

 \#\# 提出问题

在查看共享单车数据之前，你得先明确自己想了解共享单车数据的哪些方面，并就此提出问题。打个比方，假如你是
Motivate
的员工，为了做出更明智的商业决策，你会想了解什么信息呢？假如你是共享单车服务的对象，那么什么样的因素会影响你对这类服务的使用偏好呢？

\textbf{问题 1}: 写出至少两个你觉得能用数据解决的共享单车相关问题。

\textbf{答案}： 1. 80\%的人在什么时段使用共享单车？ 2.
对于某个城市，哪三个地方的人们使用共享单车的次数最多？次数分别是多少？
3. 对于某个城市，哪三个人使用共享单车的时间最长？时长分别是多少?

\begin{quote}
\textbf{小贴士}:
双击上框，文本就会发生变化，所有格式都会被清除，以便你编辑该文本块。该文本块是用
\href{http://daringfireball.net/projects/markdown/syntax}{Markdown}编写的，该语言使用纯文本语法，能用页眉、链接、斜体等来规范文本格式。在纳米学位课程中，你也会用到
Markdown。编辑后，可使用 \textbf{Shift} + \textbf{Enter} 或
\textbf{Shift} + \textbf{Return}
运行上该框，使其呈现出编辑好的文本格式。
\end{quote}

 \#\# 数据收集与整理

现在是时候收集并探索数据了。在本项目中，我们将重点关注所选城市：纽约市、芝加哥、华盛顿特区
2016 年的个人骑行记录。每座城市均有相关页面供我们随时下载骑行数据：

\begin{itemize}
\tightlist
\item
  纽约市(Citi Bike):
  \href{https://www.citibikenyc.com/system-data}{链接}
\item
  芝加哥 (Divvy): \href{https://www.divvybikes.com/system-data}{链接}
\item
  华盛顿特区 (Capital Bikeshare):
  \href{https://www.capitalbikeshare.com/system-data}{链接}
\end{itemize}

访问上述网页，你就会发现各城市提供数据的方式有所不同。芝加哥每两年更新一次数据，华盛顿特区则每个季度更新一次，纽约市则是每月一更。\textbf{不过你无需亲自下载数据。}
我们已为你收集好了数据并存放到项目文件的 \texttt{/data/}
文件夹中了，虽然各城市 2016 年的原始数据散布在多个文件中，但
\texttt{/data/}
文件夹里的文件已分别将当年各城市的所有骑行数据整合到一个文件中了。我们已为你完成了一些数据整理操作，处理了各城市数据时间戳格式不一致的问题。除此之外，我们还移除了原始数据
2\% 的随机样本，以减少探索障碍。

\textbf{问题 2}:
尽管如此，我们要研究的数据还有很多，因此，我们最好先观察各目标分析城市的某一则记录。运行下方第一个代码框，加载一些分析所需的包和函数，然后完成第二个代码框，使其分别输出各城市的第一条骑行记录（也即每个数据文件的第二行）。

\begin{quote}
\textbf{小贴士}: 运行代码框的方法与编辑上方的 Markdown
框的格式类似，你只需点击代码框，按下键盘快捷键 \textbf{Shift} +
\textbf{Enter} 或 \textbf{Shift} + \textbf{Return}
，或者你也可先选择代码框，然后点击工具栏的 \textbf{运行}
按钮来运行代码。运行代码框时，相应单元左侧的信息会出现星号，即
\texttt{In\ {[}*{]}:}，若代码执行完毕，星号则会变为某个数字，如
\texttt{In\ {[}1{]}}。如果代码运行后有输出结果，输出将会以
\texttt{Out\ {[}1{]}:} 的形式出现，其中的数字将与 "In" 中的数字相对应。
\end{quote}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}1}]:} \PY{c+c1}{\PYZsh{}\PYZsh{} 导入所有必要的包和函数。}
        \PY{k+kn}{import} \PY{n+nn}{csv} \PY{c+c1}{\PYZsh{} 读写 csv 文件}
        \PY{k+kn}{from} \PY{n+nn}{datetime} \PY{k}{import} \PY{n}{datetime} \PY{c+c1}{\PYZsh{} 日期解析操作}
        \PY{k+kn}{from} \PY{n+nn}{pprint} \PY{k}{import} \PY{n}{pprint} \PY{c+c1}{\PYZsh{} 用于输出字典等数据结构}
                                  \PY{c+c1}{\PYZsh{} 这比 base print 函数要好用。}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}2}]:} \PY{k}{def} \PY{n+nf}{print\PYZus{}first\PYZus{}point}\PY{p}{(}\PY{n}{filename}\PY{p}{)}\PY{p}{:}
            \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
        \PY{l+s+sd}{    本函数会输出并返回指定的 csv 文件 （含页眉行）的第一个数据点（即文件的第二行）。}
        \PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}
            \PY{c+c1}{\PYZsh{} 输出城市名以供参考}
            \PY{n}{city} \PY{o}{=} \PY{n}{filename}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{/}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
            \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{City: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{city}\PY{p}{)}\PY{p}{)}
            
            \PY{k}{with} \PY{n+nb}{open}\PY{p}{(}\PY{n}{filename}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{k}{as} \PY{n}{f\PYZus{}in}\PY{p}{:}
                \PY{c+c1}{\PYZsh{}\PYZsh{} 待办：用 csv 库来设置一个 DictReader 对象。\PYZsh{}\PYZsh{}}
                \PY{c+c1}{\PYZsh{}\PYZsh{} 见 https://docs.python.org/3/library/csv.html           \PYZsh{}\PYZsh{}}
                \PY{n}{trip\PYZus{}reader} \PY{o}{=} \PY{n}{csv}\PY{o}{.}\PY{n}{DictReader}\PY{p}{(}\PY{n}{f\PYZus{}in}\PY{p}{)}
                
                \PY{c+c1}{\PYZsh{}\PYZsh{} 待办：对 DictReader 对象使用函数     \PYZsh{}\PYZsh{}}
                \PY{c+c1}{\PYZsh{}\PYZsh{} 从而读取数据文件的第一条骑行记录并将其存储为一个变量     \PYZsh{}\PYZsh{}}
                \PY{c+c1}{\PYZsh{}\PYZsh{} 见 https://docs.python.org/3/library/csv.html\PYZsh{}reader\PYZhy{}objects \PYZsh{}\PYZsh{}}
                \PY{n}{first\PYZus{}trip} \PY{o}{=} \PY{n+nb}{next}\PY{p}{(}\PY{n}{trip\PYZus{}reader}\PY{p}{)}
                
                \PY{c+c1}{\PYZsh{}\PYZsh{} 待办：用 pprint 库来输出第一条骑行记录。 \PYZsh{}\PYZsh{}}
                \PY{c+c1}{\PYZsh{}\PYZsh{} 见 https://docs.python.org/3/library/pprint.html     \PYZsh{}\PYZsh{}}
                \PY{n}{pprint}\PY{p}{(}\PY{n}{first\PYZus{}trip}\PY{p}{)}
                
            \PY{c+c1}{\PYZsh{} 输出城市名和第一条骑行记录以备测试}
            \PY{k}{return} \PY{p}{(}\PY{n}{city}\PY{p}{,} \PY{n}{first\PYZus{}trip}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{} 各城市的文件列表}
        \PY{n}{data\PYZus{}files} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{./data/NYC\PYZhy{}CitiBike\PYZhy{}2016.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                      \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{./data/Chicago\PYZhy{}Divvy\PYZhy{}2016.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                      \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{./data/Washington\PYZhy{}CapitalBikeshare\PYZhy{}2016.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{p}{]}
        
        \PY{c+c1}{\PYZsh{} 输出各文件的第一条骑行记录，并将其储存在字典中}
        \PY{n}{example\PYZus{}trips} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
        \PY{k}{for} \PY{n}{data\PYZus{}file} \PY{o+ow}{in} \PY{n}{data\PYZus{}files}\PY{p}{:}
            \PY{n}{city}\PY{p}{,} \PY{n}{first\PYZus{}trip} \PY{o}{=} \PY{n}{print\PYZus{}first\PYZus{}point}\PY{p}{(}\PY{n}{data\PYZus{}file}\PY{p}{)}
            \PY{n}{example\PYZus{}trips}\PY{p}{[}\PY{n}{city}\PY{p}{]} \PY{o}{=} \PY{n}{first\PYZus{}trip}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]

City: NYC
OrderedDict([('tripduration', '839'),
             ('starttime', '1/1/2016 00:09:55'),
             ('stoptime', '1/1/2016 00:23:54'),
             ('start station id', '532'),
             ('start station name', 'S 5 Pl \& S 4 St'),
             ('start station latitude', '40.710451'),
             ('start station longitude', '-73.960876'),
             ('end station id', '401'),
             ('end station name', 'Allen St \& Rivington St'),
             ('end station latitude', '40.72019576'),
             ('end station longitude', '-73.98997825'),
             ('bikeid', '17109'),
             ('usertype', 'Customer'),
             ('birth year', ''),
             ('gender', '0')])

City: Chicago
OrderedDict([('trip\_id', '9080545'),
             ('starttime', '3/31/2016 23:30'),
             ('stoptime', '3/31/2016 23:46'),
             ('bikeid', '2295'),
             ('tripduration', '926'),
             ('from\_station\_id', '156'),
             ('from\_station\_name', 'Clark St \& Wellington Ave'),
             ('to\_station\_id', '166'),
             ('to\_station\_name', 'Ashland Ave \& Wrightwood Ave'),
             ('usertype', 'Subscriber'),
             ('gender', 'Male'),
             ('birthyear', '1990')])

City: Washington
OrderedDict([('Duration (ms)', '427387'),
             ('Start date', '3/31/2016 22:57'),
             ('End date', '3/31/2016 23:04'),
             ('Start station number', '31602'),
             ('Start station', 'Park Rd \& Holmead Pl NW'),
             ('End station number', '31207'),
             ('End station', 'Georgia Ave and Fairmont St NW'),
             ('Bike number', 'W20842'),
             ('Member Type', 'Registered')])

    \end{Verbatim}

    要是一切都填写正确的话，你就能看到下方输出了每座城市的名字（解析数据文件名而得），而其中第一条骑行记录也已解析成字典的格式。等你设置好\texttt{DictReader}对象，数据文件的第一行通常就会被处理为列名，文件其余的行则将以这些列名作为关键字，这是因为每一行都生成了一个字典对象。

这些可读性很强的标签对我们访问大量数据十分实用，有了这些，我们就无需使用数字索引，比如，如果我们有一条骑行记录储存在变量
\texttt{row}里，那就可以用
\texttt{row{[}\textquotesingle{}duration\textquotesingle{}{]}}
来获得骑行时长，无需使用 \texttt{row{[}0{]}}。

 \#\#\# 浓缩骑行数据

你应该能从上方的输出观察到每座城市提供的信息是有差别的，就算是信息相同的部分，列名和格式有时也不尽相同。为了尽可能方便真正的探索操作，我们应当对数据进行修剪和清理。清理数据以保证各城市数据格式一致，修剪数据则能让我们把重心完全放到最关心的那部分数据上，从而减小探索难度。

你将生成新的数据文件，该文件需包括你感兴趣的五个骑行数据值：骑行时长、起始月份、起始小时、周几以及用户类型。每座城市的这五个值都可能需要额外的整理操作，这取决于各城市的数据差异：

\begin{itemize}
\tightlist
\item
  \textbf{时长}：该值可能以秒数（纽约市、芝加哥）或毫秒数（华盛顿特区）表示，但就分析而言，分析单位为分钟更佳，所以如果能将所有骑行时长都以分钟表示就好了。
\item
  \textbf{月份}, \textbf{小时},
  \textbf{周几}：季节、一天的什么时候以及是否周末都有可能影响骑客量，请用骑行起始时间来获取这些值。纽约市数据的时间戳记录了秒数，而华盛顿特区和芝加哥的并没有。
  此处使用
  \href{https://docs.python.org/3/library/datetime.html}{\texttt{datetime}}
  包应大有帮助，该包可实现必要的转换操作。
\item
  \textbf{用户类型}：
  共享单车系统的注册用户可能与临时用户有不同的使用模式。华盛顿特区将其用户分为两种：`注册用户'
  ------这类用户买了较长时期的会员，如年度会员或月度会员；`临时用户'------这类用户所购买的骑行时间较短，如只有
  24 小时或 3 天。纽约市和芝加哥的数据则用 `会员' 和 `散客'
  来区分这两者。为了保证数据的一致性，你需要修改华盛顿特区的标签，使其与另外两座城市的标签相同。
\end{itemize}

\textbf{问题 3a}：完成下方代码框中的辅助函数，完成上述各项清理任务。

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}3}]:} \PY{k}{def} \PY{n+nf}{duration\PYZus{}in\PYZus{}mins}\PY{p}{(}\PY{n}{datum}\PY{p}{,} \PY{n}{city}\PY{p}{)}\PY{p}{:}
            \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
        \PY{l+s+sd}{    将一个字典作为输入，该字典需包含一条骑行记录（数据）}
        \PY{l+s+sd}{    及记录城市（城市）的信息，返回该骑行的时长，使该时长以分钟为单位。}
        \PY{l+s+sd}{    }
        \PY{l+s+sd}{    记住，华盛顿特区是以毫秒作为计量单位的，而芝加哥和纽约市则}
        \PY{l+s+sd}{    以秒数作为单位。}
        \PY{l+s+sd}{    }
        \PY{l+s+sd}{    提示：csv 模块会将所有数据读取为字符串，包括数值，}
        \PY{l+s+sd}{    所以转换单位时，你需要用一个函数来将字符串转换为合适的数值类型。}
        \PY{l+s+sd}{    见 https://docs.python.org/3/library/functions.html}
        \PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}
            
            \PY{c+c1}{\PYZsh{} 请在此处写出代码}
            \PY{n}{duration} \PY{o}{=} \PY{l+m+mi}{0}
            \PY{k}{if} \PY{n}{city} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Washington}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
                \PY{n}{duration} \PY{o}{=} \PY{n+nb}{float}\PY{p}{(}\PY{n}{datum}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Duration (ms)}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)} \PY{o}{/} \PY{l+m+mi}{60000}
            \PY{k}{else}\PY{p}{:}
                \PY{n}{duration} \PY{o}{=} \PY{n+nb}{float}\PY{p}{(}\PY{n}{datum}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tripduration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)} \PY{o}{/} \PY{l+m+mi}{60}
            \PY{k}{return} \PY{n}{duration}
        
        
        \PY{c+c1}{\PYZsh{} 测试代码是否奏效，若所有断言都没问题，则不应有输出出现。}
        \PY{c+c1}{\PYZsh{} 至于字典 `example\PYZus{}trips` }
        \PY{c+c1}{\PYZsh{} 则是在你输出每个数据源文件的第一条骑行数据时生成的。}
        \PY{n}{tests} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NYC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mf}{13.9833}\PY{p}{,}
                 \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Chicago}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mf}{15.4333}\PY{p}{,}
                 \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Washington}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mf}{7.1231}\PY{p}{\PYZcb{}}
        
        \PY{k}{for} \PY{n}{city} \PY{o+ow}{in} \PY{n}{tests}\PY{p}{:}
            \PY{k}{assert} \PY{n+nb}{abs}\PY{p}{(}\PY{n}{duration\PYZus{}in\PYZus{}mins}\PY{p}{(}\PY{n}{example\PYZus{}trips}\PY{p}{[}\PY{n}{city}\PY{p}{]}\PY{p}{,} \PY{n}{city}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{n}{tests}\PY{p}{[}\PY{n}{city}\PY{p}{]}\PY{p}{)} \PY{o}{\PYZlt{}} \PY{o}{.}\PY{l+m+mi}{001}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}4}]:} \PY{k}{def} \PY{n+nf}{time\PYZus{}of\PYZus{}trip}\PY{p}{(}\PY{n}{datum}\PY{p}{,} \PY{n}{city}\PY{p}{)}\PY{p}{:}
            \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
        \PY{l+s+sd}{    将一个字典作为输入，该字典需包含一条骑行记录（数据）}
        \PY{l+s+sd}{    及记录城市（城市）的信息，返回该骑行进行的月份、小时及周几这三个值。}
        \PY{l+s+sd}{    }
        \PY{l+s+sd}{    }
        \PY{l+s+sd}{    记住，纽约市以秒为单位，华盛顿特区和芝加哥则不然。}
        \PY{l+s+sd}{    }
        \PY{l+s+sd}{    提示：你需要用 datetime 模块来将原始日期字符串解析为}
        \PY{l+s+sd}{    方便提取目的信息的格式。}
        \PY{l+s+sd}{    见 https://docs.python.org/3/library/datetime.html\PYZsh{}strftime\PYZhy{}and\PYZhy{}strptime\PYZhy{}behavior}
        \PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}
            
            \PY{c+c1}{\PYZsh{} 请在此处写出代码}
            \PY{k}{if} \PY{n}{city} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NYC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
                \PY{n}{start\PYZus{}time} \PY{o}{=} \PY{n}{datum}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{starttime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
                \PY{n}{start\PYZus{}time} \PY{o}{=} \PY{n}{datetime}\PY{o}{.}\PY{n}{strptime}\PY{p}{(}\PY{n}{start\PYZus{}time}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZpc{}}\PY{l+s+s1}{m/}\PY{l+s+si}{\PYZpc{}d}\PY{l+s+s1}{/}\PY{l+s+s1}{\PYZpc{}}\PY{l+s+s1}{Y }\PY{l+s+s1}{\PYZpc{}}\PY{l+s+s1}{H:}\PY{l+s+s1}{\PYZpc{}}\PY{l+s+s1}{M:}\PY{l+s+s1}{\PYZpc{}}\PY{l+s+s1}{S}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
            \PY{k}{elif} \PY{n}{city} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Chicago}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
                \PY{n}{start\PYZus{}time} \PY{o}{=} \PY{n}{datum}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{starttime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
                \PY{n}{start\PYZus{}time} \PY{o}{=} \PY{n}{datetime}\PY{o}{.}\PY{n}{strptime}\PY{p}{(}\PY{n}{start\PYZus{}time}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZpc{}}\PY{l+s+s1}{m/}\PY{l+s+si}{\PYZpc{}d}\PY{l+s+s1}{/}\PY{l+s+s1}{\PYZpc{}}\PY{l+s+s1}{Y }\PY{l+s+s1}{\PYZpc{}}\PY{l+s+s1}{H:}\PY{l+s+s1}{\PYZpc{}}\PY{l+s+s1}{M}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
            \PY{k}{else}\PY{p}{:}   \PY{c+c1}{\PYZsh{} Washington}
                \PY{n}{start\PYZus{}time} \PY{o}{=} \PY{n}{datum}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Start date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
                \PY{n}{start\PYZus{}time} \PY{o}{=} \PY{n}{datetime}\PY{o}{.}\PY{n}{strptime}\PY{p}{(}\PY{n}{start\PYZus{}time}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{m/}\PY{l+s+si}{\PYZpc{}d}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{Y }\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{H:}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{M}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
            \PY{n}{tt} \PY{o}{=} \PY{n}{start\PYZus{}time}\PY{o}{.}\PY{n}{timetuple}\PY{p}{(}\PY{p}{)}   \PY{c+c1}{\PYZsh{} year, month, day, hour, minutes, second, weekday, day of year, \PYZhy{}1}
            \PY{n}{month} \PY{o}{=} \PY{n}{tt}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
            \PY{n}{hour} \PY{o}{=} \PY{n}{tt}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}
            \PY{n}{day\PYZus{}of\PYZus{}week} \PY{o}{=} \PY{n}{datetime}\PY{o}{.}\PY{n}{strftime}\PY{p}{(}\PY{n}{start\PYZus{}time}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZpc{}}\PY{l+s+s1}{A}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
            \PY{k}{return} \PY{p}{(}\PY{n}{month}\PY{p}{,} \PY{n}{hour}\PY{p}{,} \PY{n}{day\PYZus{}of\PYZus{}week}\PY{p}{)}
        
        
        \PY{c+c1}{\PYZsh{} 测试代码是否奏效，若所有断言都没问题，则不应有输出出现。}
        \PY{c+c1}{\PYZsh{} 至于字典 `example\PYZus{}trips`}
        \PY{c+c1}{\PYZsh{} 则是在你输出每个数据源文件的第一条骑行数据时生成的。}
        \PY{n}{tests} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NYC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Friday}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
                 \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Chicago}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,} \PY{l+m+mi}{23}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Thursday}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
                 \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Washington}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,} \PY{l+m+mi}{22}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Thursday}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{\PYZcb{}}
        
        \PY{k}{for} \PY{n}{city} \PY{o+ow}{in} \PY{n}{tests}\PY{p}{:}
            \PY{k}{assert} \PY{n}{time\PYZus{}of\PYZus{}trip}\PY{p}{(}\PY{n}{example\PYZus{}trips}\PY{p}{[}\PY{n}{city}\PY{p}{]}\PY{p}{,} \PY{n}{city}\PY{p}{)} \PY{o}{==} \PY{n}{tests}\PY{p}{[}\PY{n}{city}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}4}]:} \PY{k}{def} \PY{n+nf}{type\PYZus{}of\PYZus{}user}\PY{p}{(}\PY{n}{datum}\PY{p}{,} \PY{n}{city}\PY{p}{)}\PY{p}{:}
            \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
        \PY{l+s+sd}{    将一个字典作为输入，该字典需包含一条骑行记录（数据）}
        \PY{l+s+sd}{    及记录城市（城市）的信息，返回进行该骑行的系统用户类型。}
        \PY{l+s+sd}{    }
        \PY{l+s+sd}{    }
        \PY{l+s+sd}{    记住，华盛顿特区的类名与芝加哥和纽约市的不同。}
        \PY{l+s+sd}{    }
        \PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}
            
            \PY{c+c1}{\PYZsh{} 请在此处写出代码}
            \PY{k}{if} \PY{n}{city} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Washington}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
                \PY{n}{member\PYZus{}type} \PY{o}{=} \PY{n}{datum}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Member Type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
                \PY{k}{if} \PY{n}{member\PYZus{}type} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Registered}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
                    \PY{n}{user\PYZus{}type} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Subscriber}\PY{l+s+s1}{\PYZsq{}}
                \PY{k}{else}\PY{p}{:}
                    \PY{n}{user\PYZus{}type} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Customer}\PY{l+s+s1}{\PYZsq{}}
            \PY{k}{else}\PY{p}{:}
                \PY{n}{user\PYZus{}type} \PY{o}{=} \PY{n}{datum}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{usertype}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
            \PY{k}{return} \PY{n}{user\PYZus{}type}
        
        
        \PY{c+c1}{\PYZsh{} 测试代码是否奏效，若所有断言都没问题，则不应有输出出现。}
        \PY{c+c1}{\PYZsh{} 至于字典 `example\PYZus{}trips`}
        \PY{c+c1}{\PYZsh{} 则是在你输出每个数据源文件的第一条骑行数据时生成的。}
        \PY{n}{tests} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NYC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Customer}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                 \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Chicago}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Subscriber}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                 \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Washington}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Subscriber}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}
        
        \PY{k}{for} \PY{n}{city} \PY{o+ow}{in} \PY{n}{tests}\PY{p}{:}
            \PY{k}{assert} \PY{n}{type\PYZus{}of\PYZus{}user}\PY{p}{(}\PY{n}{example\PYZus{}trips}\PY{p}{[}\PY{n}{city}\PY{p}{]}\PY{p}{,} \PY{n}{city}\PY{p}{)} \PY{o}{==} \PY{n}{tests}\PY{p}{[}\PY{n}{city}\PY{p}{]}
\end{Verbatim}


    \textbf{问题 3b}:
现在，使用你在上方编写的辅助函数来为每座城市生成数据浓缩文件，该文件将只包括上述数据区。在
\texttt{/examples/}
文件夹里，你将看到转换前后的数据文件示例，该示例来自\href{http://www.bayareabikeshare.com/open-data}{旧金山湾区共享单车}。请确保你的输出结果与示例文件具备一致的格式。

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}5}]:} \PY{k}{def} \PY{n+nf}{condense\PYZus{}data}\PY{p}{(}\PY{n}{in\PYZus{}file}\PY{p}{,} \PY{n}{out\PYZus{}file}\PY{p}{,} \PY{n}{city}\PY{p}{)}\PY{p}{:}
            \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
        \PY{l+s+sd}{    本函数会从指定的输入文件中提取全部数据}
        \PY{l+s+sd}{    并在指定的输出文件中写出浓缩数据。}
        \PY{l+s+sd}{    城市参数决定输入文件的解析方式。}
        \PY{l+s+sd}{    }
        \PY{l+s+sd}{    提示：参考下框以明确参数结构！}
        \PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}
            
            \PY{k}{with} \PY{n+nb}{open}\PY{p}{(}\PY{n}{out\PYZus{}file}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{w}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{k}{as} \PY{n}{f\PYZus{}out}\PY{p}{,} \PY{n+nb}{open}\PY{p}{(}\PY{n}{in\PYZus{}file}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{k}{as} \PY{n}{f\PYZus{}in}\PY{p}{:}
                \PY{c+c1}{\PYZsh{} 设置 csv DictWriter 对象——该对象需将第一列列名}
                \PY{c+c1}{\PYZsh{} 作为 \PYZdq{}fieldnames\PYZdq{} 参数}
                \PY{n}{out\PYZus{}colnames} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{hour}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{day\PYZus{}of\PYZus{}week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{user\PYZus{}type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}        
                \PY{n}{trip\PYZus{}writer} \PY{o}{=} \PY{n}{csv}\PY{o}{.}\PY{n}{DictWriter}\PY{p}{(}\PY{n}{f\PYZus{}out}\PY{p}{,} \PY{n}{fieldnames} \PY{o}{=} \PY{n}{out\PYZus{}colnames}\PY{p}{)}
                \PY{n}{trip\PYZus{}writer}\PY{o}{.}\PY{n}{writeheader}\PY{p}{(}\PY{p}{)}
                
                \PY{c+c1}{\PYZsh{}\PYZsh{} 待办：设置 csv DictReader 对象\PYZsh{}\PYZsh{}}
                \PY{n}{trip\PYZus{}reader} \PY{o}{=} \PY{n}{csv}\PY{o}{.}\PY{n}{DictReader}\PY{p}{(}\PY{n}{f\PYZus{}in}\PY{p}{)} 
        
                \PY{c+c1}{\PYZsh{} 收集并处理每行的数据}
                \PY{k}{for} \PY{n}{row} \PY{o+ow}{in} \PY{n}{trip\PYZus{}reader}\PY{p}{:}
                    \PY{c+c1}{\PYZsh{} 设置一个字典来存储清理和修剪后的数据点的值}
                    \PY{n}{new\PYZus{}point} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
        
                    \PY{c+c1}{\PYZsh{}\PYZsh{} 待办：使用辅助函数来从原始数据字典中获取清理数据\PYZsh{}\PYZsh{}}
                    \PY{n}{duration} \PY{o}{=} \PY{n}{duration\PYZus{}in\PYZus{}mins}\PY{p}{(}\PY{n}{row}\PY{p}{,} \PY{n}{city}\PY{p}{)}
                    \PY{n}{month}\PY{p}{,} \PY{n}{hour}\PY{p}{,} \PY{n}{day\PYZus{}of\PYZus{}week} \PY{o}{=} \PY{n}{time\PYZus{}of\PYZus{}trip}\PY{p}{(}\PY{n}{row}\PY{p}{,} \PY{n}{city}\PY{p}{)}
                    \PY{n}{user\PYZus{}type} \PY{o}{=} \PY{n}{type\PYZus{}of\PYZus{}user}\PY{p}{(}\PY{n}{row}\PY{p}{,} \PY{n}{city}\PY{p}{)}
                    \PY{n}{new\PYZus{}point}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{duration}
                    \PY{n}{new\PYZus{}point}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{month}
                    \PY{n}{new\PYZus{}point}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{hour}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{hour}
                    \PY{n}{new\PYZus{}point}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{day\PYZus{}of\PYZus{}week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{day\PYZus{}of\PYZus{}week}
                    \PY{n}{new\PYZus{}point}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{user\PYZus{}type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{user\PYZus{}type}
        
                    \PY{c+c1}{\PYZsh{}\PYZsh{} 注意字典 new\PYZus{}point 的关键词应与 \PYZsh{}\PYZsh{}}
                    \PY{c+c1}{\PYZsh{}\PYZsh{} 上述 DictWriter 对象设置的列名一致。        \PYZsh{}\PYZsh{}}
                    
        
                    \PY{c+c1}{\PYZsh{}\PYZsh{} 待办：在输出文件中写出处理后的信息。\PYZsh{}\PYZsh{}}
                    \PY{c+c1}{\PYZsh{}\PYZsh{} 见 https://docs.python.org/3/library/csv.html\PYZsh{}writer\PYZhy{}objects \PYZsh{}\PYZsh{}}
                    \PY{n}{trip\PYZus{}writer}\PY{o}{.}\PY{n}{writerow}\PY{p}{(}\PY{n}{new\PYZus{}point}\PY{p}{)}
                    
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}7}]:} \PY{c+c1}{\PYZsh{} 运行下框以测试效果}
        \PY{n}{city\PYZus{}info} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Washington}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{in\PYZus{}file}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{./data/Washington\PYZhy{}CapitalBikeshare\PYZhy{}2016.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{out\PYZus{}file}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{./data/Washington\PYZhy{}2016\PYZhy{}Summary.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}\PY{p}{,}
                     \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Chicago}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{in\PYZus{}file}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{./data/Chicago\PYZhy{}Divvy\PYZhy{}2016.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                 \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{out\PYZus{}file}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{./data/Chicago\PYZhy{}2016\PYZhy{}Summary.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}\PY{p}{,}
                     \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NYC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{in\PYZus{}file}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{./data/NYC\PYZhy{}CitiBike\PYZhy{}2016.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                             \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{out\PYZus{}file}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{./data/NYC\PYZhy{}2016\PYZhy{}Summary.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}\PY{p}{\PYZcb{}}
        
        \PY{k}{for} \PY{n}{city}\PY{p}{,} \PY{n}{filenames} \PY{o+ow}{in} \PY{n}{city\PYZus{}info}\PY{o}{.}\PY{n}{items}\PY{p}{(}\PY{p}{)}\PY{p}{:}
            \PY{n}{condense\PYZus{}data}\PY{p}{(}\PY{n}{filenames}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{in\PYZus{}file}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{filenames}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{out\PYZus{}file}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{city}\PY{p}{)}
            \PY{n}{print\PYZus{}first\PYZus{}point}\PY{p}{(}\PY{n}{filenames}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{out\PYZus{}file}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]

City: Washington
OrderedDict([('duration', '7.123116666666666'),
             ('month', '3'),
             ('hour', '22'),
             ('day\_of\_week', 'Thursday'),
             ('user\_type', 'Subscriber')])

City: Chicago
OrderedDict([('duration', '15.433333333333334'),
             ('month', '3'),
             ('hour', '23'),
             ('day\_of\_week', 'Thursday'),
             ('user\_type', 'Subscriber')])

City: NYC
OrderedDict([('duration', '13.983333333333333'),
             ('month', '1'),
             ('hour', '0'),
             ('day\_of\_week', 'Friday'),
             ('user\_type', 'Customer')])

    \end{Verbatim}

    \begin{quote}
\textbf{小贴士}：对 Jupyter Notebook
进行保存，运行代码块所得的输出结果也会得到保存，不过，一旦开始了新节，工作空间的状态就会被重置，所以你得运行上一节涉及的所有必要代码块，重建变量和函数，方能找回上次离开的进度。
\end{quote}

 \#\# 探索性数据分析

现在你已经收集并整理了数据，可以开始探索数据了。在本节中，你将编写一些代码来对数据进行描述统计。我们还将为你介绍
\texttt{matplotlib} 库，以便你为数据创建一些基本直方图。

 \#\#\# 统计数据

首先，我们来进行一些基本统计。下方的第一个框里包括了一个函数，该函数会用
csv
模块来对给定的数据文件进行迭代处理，并返回会员和散客的骑行次数。第二个框则会运行
\texttt{/examples/}
文件夹里湾区示例数据中的函数。修改下框，回答下列问题。

\textbf{问题
4a}：哪座城市的骑行次数最多？哪座城市会员进行的骑行次数占比最高？哪座城市散客进行的骑行次数占比最高？

\textbf{答案}：请在此处写出答案！

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}12}]:} \PY{k}{def} \PY{n+nf}{number\PYZus{}of\PYZus{}trips}\PY{p}{(}\PY{n}{filename}\PY{p}{)}\PY{p}{:}
             \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
         \PY{l+s+sd}{    本函数会读取一个骑行数据文件，分别报告}
         \PY{l+s+sd}{    会员、散客和所有系统用户的骑行次数。}
         \PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}
             \PY{k}{with} \PY{n+nb}{open}\PY{p}{(}\PY{n}{filename}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{k}{as} \PY{n}{f\PYZus{}in}\PY{p}{:}
                 \PY{c+c1}{\PYZsh{} 设置 csv reader 对象}
                 \PY{n}{reader} \PY{o}{=} \PY{n}{csv}\PY{o}{.}\PY{n}{DictReader}\PY{p}{(}\PY{n}{f\PYZus{}in}\PY{p}{)}
                 \PY{n}{city} \PY{o}{=} \PY{n}{filename}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
                 
                 \PY{c+c1}{\PYZsh{} 初始化计数变量}
                 \PY{n}{n\PYZus{}subscribers} \PY{o}{=} \PY{l+m+mi}{0}
                 \PY{n}{n\PYZus{}customers} \PY{o}{=} \PY{l+m+mi}{0}
                 \PY{n}{d\PYZus{}subscribers} \PY{o}{=} \PY{l+m+mi}{0}
                 \PY{n}{d\PYZus{}customers} \PY{o}{=} \PY{l+m+mi}{0}
                 
                 \PY{c+c1}{\PYZsh{} 计算骑行类型}
                 \PY{k}{for} \PY{n}{row} \PY{o+ow}{in} \PY{n}{reader}\PY{p}{:}
                     \PY{n}{duration} \PY{o}{=} \PY{n+nb}{float}\PY{p}{(}\PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
                     \PY{k}{if} \PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{user\PYZus{}type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Subscriber}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
                         \PY{n}{n\PYZus{}subscribers} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                         \PY{n}{d\PYZus{}subscribers} \PY{o}{+}\PY{o}{=} \PY{n}{duration}
                     \PY{k}{else}\PY{p}{:}
                         \PY{n}{n\PYZus{}customers} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                         \PY{n}{d\PYZus{}customers} \PY{o}{+}\PY{o}{=} \PY{n}{duration}
                 
                 \PY{c+c1}{\PYZsh{} 统计骑行总次数}
                 \PY{n}{n\PYZus{}total} \PY{o}{=} \PY{n}{n\PYZus{}subscribers} \PY{o}{+} \PY{n}{n\PYZus{}customers}
                 
                 \PY{c+c1}{\PYZsh{} 把数据放到字典里面}
                 \PY{n}{city\PYZus{}data} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
                 \PY{n}{city\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{city}
                 \PY{n}{city\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{n\PYZus{}subscribers}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{n\PYZus{}subscribers}
                 \PY{n}{city\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{n\PYZus{}customers}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{n\PYZus{}customers}
                 \PY{n}{city\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{d\PYZus{}subscribers}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{d\PYZus{}subscribers}
                 \PY{n}{city\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{d\PYZus{}customers}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{d\PYZus{}customers}
                 \PY{n}{city\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{n\PYZus{}total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{n\PYZus{}total}
                 
                 \PY{c+c1}{\PYZsh{} 将结果作为字典返回出来}
                 \PY{k}{return}\PY{p}{(}\PY{n}{city\PYZus{}data}\PY{p}{)}
             
         \PY{k}{def} \PY{n+nf}{city\PYZus{}statistics}\PY{p}{(}\PY{n}{city\PYZus{}data\PYZus{}list}\PY{p}{)}\PY{p}{:}
             \PY{n}{most\PYZus{}trips} \PY{o}{=} \PY{l+m+mi}{0}
             \PY{n}{most\PYZus{}p\PYZus{}subscribes} \PY{o}{=} \PY{l+m+mi}{0}
             \PY{n}{most\PYZus{}p\PYZus{}customers} \PY{o}{=} \PY{l+m+mi}{0}
             \PY{k}{for} \PY{n}{data} \PY{o+ow}{in} \PY{n}{city\PYZus{}data\PYZus{}list}\PY{p}{:}
                 \PY{c+c1}{\PYZsh{} 计算骑行比例}
                 \PY{n}{n\PYZus{}total} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{n\PYZus{}total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
                 \PY{n}{p\PYZus{}subscribers} \PY{o}{=} \PY{n+nb}{float}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{n\PYZus{}subscribers}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)} \PY{o}{/} \PY{n}{n\PYZus{}total}
                 \PY{n}{p\PYZus{}customers} \PY{o}{=} \PY{n+nb}{float}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{n\PYZus{}customers}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)} \PY{o}{/} \PY{n}{n\PYZus{}total}
                 
                 \PY{k}{if} \PY{n}{n\PYZus{}total} \PY{o}{\PYZgt{}} \PY{n}{most\PYZus{}trips}\PY{p}{:}
                     \PY{n}{most\PYZus{}trips} \PY{o}{=} \PY{n}{n\PYZus{}total}
                     \PY{n}{city\PYZus{}of\PYZus{}most\PYZus{}trips} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
                 \PY{k}{if} \PY{n}{p\PYZus{}subscribers} \PY{o}{\PYZgt{}} \PY{n}{most\PYZus{}p\PYZus{}subscribes}\PY{p}{:}
                     \PY{n}{most\PYZus{}p\PYZus{}subscribes} \PY{o}{=} \PY{n}{p\PYZus{}subscribers}
                     \PY{n}{city\PYZus{}of\PYZus{}most\PYZus{}p\PYZus{}subscribes} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
                 \PY{k}{if} \PY{n}{p\PYZus{}customers} \PY{o}{\PYZgt{}} \PY{n}{most\PYZus{}p\PYZus{}customers}\PY{p}{:}
                     \PY{n}{most\PYZus{}p\PYZus{}customers} \PY{o}{=} \PY{n}{p\PYZus{}customers}
                     \PY{n}{city\PYZus{}of\PYZus{}most\PYZus{}p\PYZus{}customers} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZob{}0\PYZcb{}}\PY{l+s+s2}{ has the highest number of trips.}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}}\PYZbs{}
                   \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZob{}1\PYZcb{}}\PY{l+s+s2}{ has the highest proportion of trips made by subscribers.}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}}\PYZbs{}
                   \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZob{}2\PYZcb{}}\PY{l+s+s2}{ has the highest proportion of trips made by short\PYZhy{}term customers.}\PY{l+s+s2}{\PYZdq{}}
                   \PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{city\PYZus{}of\PYZus{}most\PYZus{}trips}\PY{p}{,} \PY{n}{city\PYZus{}of\PYZus{}most\PYZus{}p\PYZus{}subscribes}\PY{p}{,} \PY{n}{city\PYZus{}of\PYZus{}most\PYZus{}p\PYZus{}customers}\PY{p}{)}\PY{p}{)}
             \PY{k}{return} \PY{n}{city\PYZus{}of\PYZus{}most\PYZus{}trips}\PY{p}{,} \PY{n}{city\PYZus{}of\PYZus{}most\PYZus{}p\PYZus{}subscribes}\PY{p}{,} \PY{n}{city\PYZus{}of\PYZus{}most\PYZus{}p\PYZus{}customers}
              
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}13}]:} \PY{c+c1}{\PYZsh{}\PYZsh{} 修改此框及上框，回答问题 4a。\PYZsh{}\PYZsh{}}
         \PY{c+c1}{\PYZsh{}\PYZsh{} 记得运行你在问题 3 中创建的数据文件清理函数。     \PYZsh{}\PYZsh{}}
         
         \PY{n}{Washington\PYZus{}file} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{./data/Washington\PYZhy{}2016\PYZhy{}Summary.csv}\PY{l+s+s1}{\PYZsq{}}
         \PY{n}{Chicago\PYZus{}file} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{./data/Chicago\PYZhy{}2016\PYZhy{}Summary.csv}\PY{l+s+s1}{\PYZsq{}}
         \PY{n}{NYC\PYZus{}file} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{./data/NYC\PYZhy{}2016\PYZhy{}Summary.csv}\PY{l+s+s1}{\PYZsq{}}
         
         \PY{n}{Washington\PYZus{}data} \PY{o}{=} \PY{n}{number\PYZus{}of\PYZus{}trips}\PY{p}{(}\PY{n}{Washington\PYZus{}file}\PY{p}{)}
         \PY{n}{Chicago\PYZus{}data} \PY{o}{=} \PY{n}{number\PYZus{}of\PYZus{}trips}\PY{p}{(}\PY{n}{Chicago\PYZus{}file}\PY{p}{)}
         \PY{n}{NYC\PYZus{}data} \PY{o}{=} \PY{n}{number\PYZus{}of\PYZus{}trips}\PY{p}{(}\PY{n}{NYC\PYZus{}file}\PY{p}{)}
         
         \PY{n}{city\PYZus{}data\PYZus{}list} \PY{o}{=} \PY{p}{[}\PY{n}{Washington\PYZus{}data}\PY{p}{,} \PY{n}{Chicago\PYZus{}data}\PY{p}{,} \PY{n}{NYC\PYZus{}data}\PY{p}{]}
         
         \PY{n}{city\PYZus{}statistics}\PY{p}{(}\PY{n}{city\PYZus{}data\PYZus{}list}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
NYC has the highest number of trips.
NYC has the highest proportion of trips made by subscribers.
Chicago has the highest proportion of trips made by short-term customers.

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}13}]:} ('NYC', 'NYC', 'Chicago')
\end{Verbatim}
            
    \begin{quote}
\textbf{小贴士}：要在 notebook 里添加框，你可以用上方菜单栏里的
"在上方插入框" 和 "在下方插入框"
功能，也可以用工具栏的相关图标来添加新框，那里还有其它图标可在文件中上移或下移框。新框默认为代码框。你还可以在框菜单或工具栏下拉菜单中为选中框指定类型（如代码框或
Markdown 框）。
\end{quote}

现在，你需要写下自己的代码，继续研究数据的属性。

\textbf{问题 4b}：共享单车系统是为短途骑行者而设的。大多数时候，用户在
30
分钟内骑行无需额外付费，若是超过该时长，则需支付超时费用。那么，各城市的平均骑行时长是多少？各城市骑行时长超过
30 分钟的比例又是多少？

\textbf{答案}：对于 Washington，平均骑行时长是 18 分钟，10.8\%
的用户骑行时长超过 30 分钟。 对于 Chicago，平均骑行时长是 16 分钟，8.3\%
的用户骑行时长超过 30 分钟。 对于 NYC，平均骑行时长是 15 分钟，7.3\%
的用户骑行时长超过 30 分钟。

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}14}]:} \PY{k}{def} \PY{n+nf}{proportion\PYZus{}above\PYZus{}given\PYZus{}time}\PY{p}{(}\PY{n}{filename}\PY{p}{,} \PY{n}{time}\PY{p}{)}\PY{p}{:}
             \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
         \PY{l+s+sd}{    This function reads in a file with trip data and return data }
         \PY{l+s+sd}{    duration of which is lager than given time.}
         \PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}
             \PY{k}{with} \PY{n+nb}{open}\PY{p}{(}\PY{n}{filename}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{k}{as} \PY{n}{f\PYZus{}in}\PY{p}{:}
                 \PY{c+c1}{\PYZsh{} set up csv reader object}
                 \PY{n}{reader} \PY{o}{=} \PY{n}{csv}\PY{o}{.}\PY{n}{DictReader}\PY{p}{(}\PY{n}{f\PYZus{}in}\PY{p}{)}
                 
                 \PY{n}{n\PYZus{}above\PYZus{}time} \PY{o}{=} \PY{l+m+mi}{0}
                 \PY{n}{n\PYZus{}total} \PY{o}{=} \PY{l+m+mi}{0}
                 \PY{k}{for} \PY{n}{data} \PY{o+ow}{in} \PY{n}{reader}\PY{p}{:}
                     \PY{n}{n\PYZus{}total} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                     \PY{k}{if} \PY{n+nb}{float}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)} \PY{o}{\PYZgt{}} \PY{n}{time}\PY{p}{:}
                         \PY{n}{n\PYZus{}above\PYZus{}time} \PY{o}{+}\PY{o}{=} \PY{l+m+mf}{1.0}
             \PY{k}{return} \PY{n}{n\PYZus{}above\PYZus{}time} \PY{o}{/} \PY{n}{n\PYZus{}total}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}15}]:} \PY{c+c1}{\PYZsh{}\PYZsh{} 使用本框及新框来回答问题 4b。               \PYZsh{}\PYZsh{}}
         \PY{c+c1}{\PYZsh{}\PYZsh{}                                                                      \PYZsh{}\PYZsh{}}
         \PY{c+c1}{\PYZsh{}\PYZsh{} 提示：csv 模块会将所有数据读取为字符串，包括数值。 \PYZsh{}\PYZsh{}}
         \PY{c+c1}{\PYZsh{}\PYZsh{} 因此，在统计数据之前，你需要用函数将字符串转换为      \PYZsh{}\PYZsh{}}
         \PY{c+c1}{\PYZsh{}\PYZsh{} 合适的数值类型。         \PYZsh{}\PYZsh{}}
         \PY{c+c1}{\PYZsh{}\PYZsh{} 小贴士：在湾区示例数据中，平均骑行时长为 14 分钟，\PYZsh{}\PYZsh{}}
         \PY{c+c1}{\PYZsh{}\PYZsh{} 骑行时长多于 30 分钟的数据占比 3.5\PYZpc{}。                      \PYZsh{}\PYZsh{}}
         \PY{k}{def} \PY{n+nf}{length\PYZus{}and\PYZus{}proportion\PYZus{}of\PYZus{}trips}\PY{p}{(}\PY{n}{filename}\PY{p}{,} \PY{n}{time}\PY{p}{)}\PY{p}{:}
             \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
         \PY{l+s+sd}{    This function reads in a file with trip data and reports the average}
         \PY{l+s+sd}{    trip length and proportion of rides that are longer than 30 minutes.}
         \PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}
             \PY{n}{city\PYZus{}data} \PY{o}{=} \PY{n}{number\PYZus{}of\PYZus{}trips}\PY{p}{(}\PY{n}{filename}\PY{p}{)}\PY{p}{;}
             \PY{n}{proportion} \PY{o}{=} \PY{n}{proportion\PYZus{}above\PYZus{}given\PYZus{}time}\PY{p}{(}\PY{n}{filename}\PY{p}{,} \PY{n}{time}\PY{p}{)}\PY{p}{;}
             \PY{n}{proportion} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZob{}:.1\PYZpc{}\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{proportion}\PY{p}{)}
             \PY{n}{city\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{proportion\PYZus{}above\PYZus{}given\PYZus{}time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{proportion}            
             \PY{n}{average\PYZus{}duration} \PY{o}{=} \PY{n+nb}{int}\PY{p}{(}\PY{p}{(}\PY{n}{city\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{d\PYZus{}subscribers}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{+} \PY{n}{city\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{d\PYZus{}customers}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)} \PY{o}{/} \PY{n}{city\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{n\PYZus{}total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{For }\PY{l+s+si}{\PYZob{}0\PYZcb{}}\PY{l+s+s1}{, the average trip length is }\PY{l+s+si}{\PYZob{}1\PYZcb{}}\PY{l+s+s1}{ minutes and }\PY{l+s+si}{\PYZob{}2\PYZcb{}}\PY{l+s+s1}{ of trips are longer than 30 minutes.}\PY{l+s+s1}{\PYZsq{}}
                  \PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{city\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{average\PYZus{}duration}\PY{p}{,} \PY{n}{proportion}\PY{p}{)}\PY{p}{)}
             \PY{k}{return} \PY{n}{city\PYZus{}data}
         
         \PY{n}{length\PYZus{}and\PYZus{}proportion\PYZus{}of\PYZus{}trips}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{./data/Washington\PYZhy{}2016\PYZhy{}Summary.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{30}\PY{p}{)}
         \PY{n}{length\PYZus{}and\PYZus{}proportion\PYZus{}of\PYZus{}trips}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{./data/Chicago\PYZhy{}2016\PYZhy{}Summary.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{30}\PY{p}{)}
         \PY{n}{length\PYZus{}and\PYZus{}proportion\PYZus{}of\PYZus{}trips}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{./data/NYC\PYZhy{}2016\PYZhy{}Summary.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{30}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
For Washington, the average trip length is 18 minutes and 10.8\% of trips are longer than 30 minutes.
For Chicago, the average trip length is 16 minutes and 8.3\% of trips are longer than 30 minutes.
For NYC, the average trip length is 15 minutes and 7.3\% of trips are longer than 30 minutes.

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}15}]:} \{'d\_customers': 1012842.4500000041,
          'd\_subscribers': 3364051.666666679,
          'n\_customers': 30902,
          'n\_subscribers': 245896,
          'n\_total': 276798,
          'name': 'NYC',
          'proportion\_above\_given\_time': '7.3\%'\}
\end{Verbatim}
            
    \textbf{问题
4c}：从骑客量的角度更深入地挖掘骑行时长问题。选择一座城市，研究该城市哪种系统用户的平均骑行时间更长？是会员还是散客？

\textbf{答案}：对于 Washington， 会员平均骑行时长是 12.5 分钟，散客是
41.7 分钟。

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}16}]:} \PY{c+c1}{\PYZsh{}\PYZsh{} 使用本框及新框来回答问题 4c。\PYZsh{}\PYZsh{}}
         \PY{c+c1}{\PYZsh{}\PYZsh{} 如果你还没这么做过，你可以考虑修改之前的代码   \PYZsh{}\PYZsh{}}
         \PY{c+c1}{\PYZsh{}\PYZsh{} 利用一些可重复利用的函数。                            \PYZsh{}\PYZsh{}}
         \PY{c+c1}{\PYZsh{}\PYZsh{}                                                                     \PYZsh{}\PYZsh{}}
         \PY{c+c1}{\PYZsh{}\PYZsh{} 小贴士：在海湾示例数据中，你应该发现    \PYZsh{}\PYZsh{}}
         \PY{c+c1}{\PYZsh{}\PYZsh{} 会员平均骑行时长为 9.5 分钟，散客平均骑行时长则为\PYZsh{}\PYZsh{}}
         \PY{c+c1}{\PYZsh{}\PYZsh{} 54.6 分钟，其它城市区别也这么大吗？     \PYZsh{}\PYZsh{}}
         \PY{c+c1}{\PYZsh{}\PYZsh{}                                                \PYZsh{}\PYZsh{}}
         \PY{n}{city\PYZus{}data} \PY{o}{=} \PY{n}{number\PYZus{}of\PYZus{}trips}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{./data/Washington\PYZhy{}2016\PYZhy{}Summary.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{avg\PYZus{}sub\PYZus{}duration} \PY{o}{=} \PY{n+nb}{format}\PY{p}{(}\PY{n}{city\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{d\PYZus{}subscribers}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{/} \PY{n}{city\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{n\PYZus{}subscribers}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.1f}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{avg\PYZus{}cus\PYZus{}duration} \PY{o}{=} \PY{n+nb}{format}\PY{p}{(}\PY{n}{city\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{d\PYZus{}customers}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{/} \PY{n}{city\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{n\PYZus{}customers}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.1f}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{For Washington, subscriber trip duration is }\PY{l+s+si}{\PYZob{}0\PYZcb{}}\PY{l+s+s2}{ minutes and the average }\PY{l+s+s2}{\PYZdq{}}
               \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Customer trip duration is }\PY{l+s+si}{\PYZob{}1\PYZcb{}}\PY{l+s+s2}{ minutes.}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{avg\PYZus{}sub\PYZus{}duration}\PY{p}{,} \PY{n}{avg\PYZus{}cus\PYZus{}duration}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
For Washington, subscriber trip duration is 12.5 minutes and the average Customer trip duration is 41.7 minutes.

    \end{Verbatim}

     \#\#\# 可视化界面

你统计出来的最后一组值应该会出现相当有趣的结果：会员平均骑行时长远低于
30 分钟，而散客的平均骑行时长则的的确确 \_超过\_了 30
分钟！要是能观察骑行时长的分布，应该会很有趣，为此，我们需要引入一个新库，即
\texttt{matplotlib}。请运行下框，加载该库以生成示例图。

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}17}]:} \PY{c+c1}{\PYZsh{} 加载库}
         \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
         
         \PY{c+c1}{\PYZsh{} 这个\PYZsq{}咒语\PYZsq{}能展示图形。}
         \PY{c+c1}{\PYZsh{} 内联 notebook，详见：}
         \PY{c+c1}{\PYZsh{} http://ipython.readthedocs.io/en/stable/interactive/magics.html}
         \PY{o}{\PYZpc{}}\PY{k}{matplotlib} inline 
         
         \PY{c+c1}{\PYZsh{} 直方图示例，数据来自湾区样本}
         \PY{n}{data} \PY{o}{=} \PY{p}{[} \PY{l+m+mf}{7.65}\PY{p}{,}  \PY{l+m+mf}{8.92}\PY{p}{,}  \PY{l+m+mf}{7.42}\PY{p}{,}  \PY{l+m+mf}{5.50}\PY{p}{,} \PY{l+m+mf}{16.17}\PY{p}{,}  \PY{l+m+mf}{4.20}\PY{p}{,}  \PY{l+m+mf}{8.98}\PY{p}{,}  \PY{l+m+mf}{9.62}\PY{p}{,} \PY{l+m+mf}{11.48}\PY{p}{,} \PY{l+m+mf}{14.33}\PY{p}{,}
                 \PY{l+m+mf}{19.02}\PY{p}{,} \PY{l+m+mf}{21.53}\PY{p}{,}  \PY{l+m+mf}{3.90}\PY{p}{,}  \PY{l+m+mf}{7.97}\PY{p}{,}  \PY{l+m+mf}{2.62}\PY{p}{,}  \PY{l+m+mf}{2.67}\PY{p}{,}  \PY{l+m+mf}{3.08}\PY{p}{,} \PY{l+m+mf}{14.40}\PY{p}{,} \PY{l+m+mf}{12.90}\PY{p}{,}  \PY{l+m+mf}{7.83}\PY{p}{,}
                 \PY{l+m+mf}{25.12}\PY{p}{,}  \PY{l+m+mf}{8.30}\PY{p}{,}  \PY{l+m+mf}{4.93}\PY{p}{,} \PY{l+m+mf}{12.43}\PY{p}{,} \PY{l+m+mf}{10.60}\PY{p}{,}  \PY{l+m+mf}{6.17}\PY{p}{,} \PY{l+m+mf}{10.88}\PY{p}{,}  \PY{l+m+mf}{4.78}\PY{p}{,} \PY{l+m+mf}{15.15}\PY{p}{,}  \PY{l+m+mf}{3.53}\PY{p}{,}
                  \PY{l+m+mf}{9.43}\PY{p}{,} \PY{l+m+mf}{13.32}\PY{p}{,} \PY{l+m+mf}{11.72}\PY{p}{,}  \PY{l+m+mf}{9.85}\PY{p}{,}  \PY{l+m+mf}{5.22}\PY{p}{,} \PY{l+m+mf}{15.10}\PY{p}{,}  \PY{l+m+mf}{3.95}\PY{p}{,}  \PY{l+m+mf}{3.17}\PY{p}{,}  \PY{l+m+mf}{8.78}\PY{p}{,}  \PY{l+m+mf}{1.88}\PY{p}{,}
                  \PY{l+m+mf}{4.55}\PY{p}{,} \PY{l+m+mf}{12.68}\PY{p}{,} \PY{l+m+mf}{12.38}\PY{p}{,}  \PY{l+m+mf}{9.78}\PY{p}{,}  \PY{l+m+mf}{7.63}\PY{p}{,}  \PY{l+m+mf}{6.45}\PY{p}{,} \PY{l+m+mf}{17.38}\PY{p}{,} \PY{l+m+mf}{11.90}\PY{p}{,} \PY{l+m+mf}{11.52}\PY{p}{,}  \PY{l+m+mf}{8.63}\PY{p}{,}\PY{p}{]}
         \PY{n}{plt}\PY{o}{.}\PY{n}{hist}\PY{p}{(}\PY{n}{data}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Distribution of Trip Durations}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Duration (m)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_19_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    在上框中，我们收集了五十个骑行时长数据，制成列表，并将该列表作为
\texttt{.hist()}
函数的第一个参数，该函数会进行统计并生成绘图对象，以便生成直方图，但我们需要执行
\texttt{.show()} 函数才能呈现统计图。\texttt{.title()} 和
\texttt{.xlabel()} 函数则提供一些标签，以便说明统计图的背景。

现在你可以使用这些函数，为你在问题 4c
所选城市的骑行时长创建直方图。请先不要将会员和散客的统计分开，你现在只需统计所有骑行时长并生成统计图即可。

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}18}]:} \PY{c+c1}{\PYZsh{}\PYZsh{} 使用本框及新框来收集所有骑行时长并制成列表。\PYZsh{}\PYZsh{}}
         \PY{c+c1}{\PYZsh{}\PYZsh{} 使用 pyplot 函数来为骑行时长生成直方图。 \PYZsh{}\PYZsh{}}
         \PY{k}{def} \PY{n+nf}{trip\PYZus{}time}\PY{p}{(}\PY{n}{filename}\PY{p}{)}\PY{p}{:}
             \PY{k}{with} \PY{n+nb}{open}\PY{p}{(}\PY{n}{filename}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{k}{as} \PY{n}{f\PYZus{}in}\PY{p}{:}
                 \PY{c+c1}{\PYZsh{} set up csv reader object}
                 \PY{n}{reader} \PY{o}{=} \PY{n}{csv}\PY{o}{.}\PY{n}{DictReader}\PY{p}{(}\PY{n}{f\PYZus{}in}\PY{p}{)}
                 \PY{n}{duration\PYZus{}list} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                 \PY{k}{for} \PY{n}{row} \PY{o+ow}{in} \PY{n}{reader}\PY{p}{:}
                     \PY{n}{duration\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n+nb}{float}\PY{p}{(}\PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}
                 \PY{k}{return} \PY{n}{duration\PYZus{}list}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}19}]:} \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
         \PY{o}{\PYZpc{}}\PY{k}{matplotlib} inline
         \PY{n}{data} \PY{o}{=} \PY{n}{trip\PYZus{}time}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{./data/Washington\PYZhy{}2016\PYZhy{}Summary.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{hist}\PY{p}{(}\PY{n}{data}\PY{p}{,} \PY{l+m+mi}{10000}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Distribution of Trip Durations}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Duration (m)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{axis}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{100}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{650}\PY{p}{]}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_22_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    如果你按示例的用法来用 \texttt{.hist()} 和 \texttt{.show()}
函数，就可能得到一张完全在意料之外的统计图，该图左侧将有一条极长的柱形，相邻的第二条柱形则可能十分短小，而且中间和右边将空出许多空间，这个时候你可以看看
x
轴的时长值，你会发现，数据里有些高度异常的极端值，不过你不需要重新处理数据，只需为
\texttt{.hist()}
函数再加一些参数，限制绘图数据的范围即可，函数相关文件请见\href{https://matplotlib.org/devdocs/api/_as_gen/matplotlib.pyplot.hist.html\#matplotlib.pyplot.hist}{{[}这里{]}}.

\textbf{问题 5}：用 \texttt{.hist()}
函数的参数来为所选城市的会员骑行时长绘制分布图，并单独为散客做同样的操作。限制统计图的范围，仅绘制骑行时长小于
75
分钟的数据。另外，你可以设置每条柱形之间有五分钟的间隔。在每组数据中，各分布图的峰值分别在哪？你会如何描述每个分布图的形状？

\textbf{答案}：请在此写出答案！

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}20}]:} \PY{c+c1}{\PYZsh{}\PYZsh{} 使用本框及新框来回答问题 5\PYZsh{}\PYZsh{}}
         \PY{k}{def} \PY{n+nf}{user\PYZus{}trip\PYZus{}time}\PY{p}{(}\PY{n}{filename}\PY{p}{,} \PY{n}{user\PYZus{}type}\PY{p}{)}\PY{p}{:}
             \PY{k}{with} \PY{n+nb}{open}\PY{p}{(}\PY{n}{filename}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{k}{as} \PY{n}{f\PYZus{}in}\PY{p}{:}
                 \PY{c+c1}{\PYZsh{} set up csv reader object}
                 \PY{n}{reader} \PY{o}{=} \PY{n}{csv}\PY{o}{.}\PY{n}{DictReader}\PY{p}{(}\PY{n}{f\PYZus{}in}\PY{p}{)}
                 \PY{n}{duration\PYZus{}list} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                 \PY{k}{for} \PY{n}{row} \PY{o+ow}{in} \PY{n}{reader}\PY{p}{:}
                     \PY{n}{duration} \PY{o}{=} \PY{n+nb}{float}\PY{p}{(}\PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
                     \PY{k}{if} \PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{user\PYZus{}type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{n}{user\PYZus{}type} \PY{o+ow}{and} \PY{n}{duration} \PY{o}{\PYZlt{}} \PY{l+m+mi}{75}\PY{p}{:}
                         \PY{n}{duration\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{duration}\PY{p}{)}
                 \PY{k}{return} \PY{n}{duration\PYZus{}list}
         
         \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
         \PY{k}{def} \PY{n+nf}{plot\PYZus{}distribution}\PY{p}{(}\PY{n}{filename}\PY{p}{,} \PY{n}{user\PYZus{}type}\PY{p}{,} \PY{n}{ymax}\PY{p}{)}\PY{p}{:}
             \PY{o}{\PYZpc{}}\PY{k}{matplotlib} inline
             \PY{n}{city} \PY{o}{=} \PY{n}{filename}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{/}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
             \PY{n}{data} \PY{o}{=} \PY{n}{user\PYZus{}trip\PYZus{}time}\PY{p}{(}\PY{n}{filename}\PY{p}{,} \PY{n}{user\PYZus{}type}\PY{p}{)}
             \PY{n}{bins} \PY{o}{=} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{80}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{)}
             \PY{n}{result} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{hist}\PY{p}{(}\PY{n}{data}\PY{p}{,} \PY{n}{bins}\PY{p}{)}
             \PY{n}{counts} \PY{o}{=} \PY{n}{result}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
             \PY{n}{xrange} \PY{o}{=} \PY{n}{result}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
             \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{n+nb}{len}\PY{p}{(}\PY{n}{counts}\PY{p}{)}\PY{p}{)}\PY{p}{:}
                 \PY{k}{if} \PY{n}{counts}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{==} \PY{n+nb}{max}\PY{p}{(}\PY{n}{counts}\PY{p}{)}\PY{p}{:}
                     \PY{n}{max\PYZus{}range} \PY{o}{=} \PY{n}{i}
                     \PY{k}{break}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{For }\PY{l+s+si}{\PYZob{}0\PYZcb{}}\PY{l+s+s2}{ }\PY{l+s+si}{\PYZob{}1\PYZcb{}}\PY{l+s+s2}{s, the peak is between }\PY{l+s+si}{\PYZob{}2\PYZcb{}}\PY{l+s+s2}{ and }\PY{l+s+si}{\PYZob{}3\PYZcb{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{city}\PY{p}{,} \PY{n}{user\PYZus{}type}\PY{p}{,} \PY{n}{xrange}\PY{p}{[}\PY{n}{max\PYZus{}range}\PY{p}{]}\PY{p}{,} \PY{n}{xrange}\PY{p}{[}\PY{n}{max\PYZus{}range} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Distribution of Trip Durations: }\PY{l+s+si}{\PYZob{}0\PYZcb{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+si}{\PYZob{}1\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{city}\PY{p}{,} \PY{n}{user\PYZus{}type}\PY{p}{)}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Duration (m)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{axis}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{80}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{,} \PY{n}{ymax}\PY{p}{]}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}21}]:} \PY{n}{plot\PYZus{}distribution}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{./data/Washington\PYZhy{}2016\PYZhy{}Summary.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Subscriber}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{18000}\PY{p}{)}
         \PY{n}{plot\PYZus{}distribution}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{./data/Washington\PYZhy{}2016\PYZhy{}Summary.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Customer}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{2200}\PY{p}{)}
         \PY{n}{plot\PYZus{}distribution}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{./data/Chicago\PYZhy{}2016\PYZhy{}Summary.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Subscriber}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{20000}\PY{p}{)}
         \PY{n}{plot\PYZus{}distribution}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{./data/Chicago\PYZhy{}2016\PYZhy{}Summary.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Customer}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{3200}\PY{p}{)}
         \PY{n}{plot\PYZus{}distribution}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{./data/NYC\PYZhy{}2016\PYZhy{}Summary.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Subscriber}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{90000}\PY{p}{)}
         \PY{n}{plot\PYZus{}distribution}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{./data/NYC\PYZhy{}2016\PYZhy{}Summary.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Customer}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{6000}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
For Washington Subscribers, the peak is between 5 and 10.

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_25_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]

For Washington Customers, the peak is between 15 and 20.

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_25_3.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]

For Chicago Subscribers, the peak is between 5 and 10.

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_25_5.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]

For Chicago Customers, the peak is between 20 and 25.

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_25_7.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]

For NYC Subscribers, the peak is between 5 and 10.

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_25_9.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]

For NYC Customers, the peak is between 20 and 25.

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_25_11.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]


    \end{Verbatim}

     \#\# 进行你自己的分析

到目前为止，你已经对手头的数据进行了初步的探索，对比了三座美国城市的相应骑行量，以及会员和散客的骑行比例，你还选取了其中一座城市，从一般骑行时长的角度来研究会员和散客的区别，接下来的探索，你就要自己选择研究方向了，以下是一些探索方向的建议：

\begin{itemize}
\tightlist
\item
  不同月份或季度的骑客量有什么区别？哪个月份/季度的骑客量最高？会员骑行量与散客骑行量之比会受月份或季度的影响吗？
\item
  周末和工作日的系统用户骑行模式有何区别？哪一天会员更可能使用骑行系统？散客呢？平均骑行时长会受一周内不同日期的影响吗？
\item
  一天内的哪个时候系统使用最频繁？会员和散客的使用模式有区别吗？
\end{itemize}

若你在问题 1
回答中提出的任何问题与上述参考类似，那现在就是研究这些的好时机。作为研究的一部分，你需要创建可视化界面，如果不想创建直方图，你可以参考
\href{https://matplotlib.org/devdocs/api/pyplot_summary.html}{Pyplot
文件}。值得一提的是，如果你想为分类变量的不同值绘制统计图（如城市、用户类型），柱形图会大有帮助。\href{https://matplotlib.org/devdocs/api/_as_gen/matplotlib.pyplot.bar.html\#matplotlib.pyplot.bar}{\texttt{.bar()}文件页面}底部具备相关示例链接，可供你参考，助你创建自己需要的统计图。

\textbf{问题 6}： 1. 对于
NYC，每周哪个时间段用户使用共享单车次数和时长最多？每天时段中会员和散客有区别吗？
附加问题： 2. 在 NYC
的所有站点中，哪三个站点去往其他站点最多？它们各自去往其他站点的次数是多少？对于这三大站点中，每个站点去玩其他最多的十个站点是什么，次数分别是多少？请画图描述。

\textbf{答案}: 1.
从每天的图中，可以看出用户在周三使用共享单车的次数最多，在周五使用时长最多。在小时图中，会员和散客有巨大区别。会员有明显的峰值，上午
8：00和下午 17：00 是骑车高峰期，可以猜测这是上下班高峰期。并且下午
18：00
仍然有用户骑车，可见人们下班更倾向于使用共享单车。与此相反的是，散客骑车时间段相对比较平稳，没有太大的起伏。而且数量比会员明显少很多。
2. 从站点图中可以看出，NYC 三大自行车站是 Avenue D \& E 3 St，E 30 St \&
Park Ave S，和 W 21 St \& 6 Ave。其中 Avenue D \& E 3 St 去往 352
个站点共有 2969 次。E 30 St \& Park Ave S 去往 323 个站点共有 2085 次. W
21 St \& 6 Ave 去往 275 个站点共 1991
次。各自的十大去向站点如图，边上的数据是去往的次数，红色为最大的。由于有些站点名字相同，经纬度不同，括号中用站点
id 区分。

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}22}]:} \PY{c+c1}{\PYZsh{}\PYZsh{} 使用本框及新框来继续探索数据集。 \PYZsh{}\PYZsh{}}
         \PY{c+c1}{\PYZsh{}\PYZsh{} 一旦你进行了自己的探索，请写下你的发现 \PYZsh{}\PYZsh{}}
         \PY{c+c1}{\PYZsh{}\PYZsh{} 请将发现写在上方的 Markdown 框中。                                     \PYZsh{}\PYZsh{}}
         \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
         \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
         \PY{l+s+sd}{Answer to Question 1:}
         \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
         \PY{k}{def} \PY{n+nf}{get\PYZus{}data\PYZus{}by\PYZus{}time}\PY{p}{(}\PY{n}{filename}\PY{p}{)}\PY{p}{:}
             \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
         \PY{l+s+sd}{    This function reads in a file with trip data and return data dividing by user type.}
         \PY{l+s+sd}{    The return value is a dictionary. For week, the first index is the day of week. The value is a list, }
         \PY{l+s+sd}{    for which the first is numbers of trips and the second is the duration in this day.}
         \PY{l+s+sd}{    For hour list, the index is the time, the value is the numbers.}
         \PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}
             \PY{k}{with} \PY{n+nb}{open}\PY{p}{(}\PY{n}{filename}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{k}{as} \PY{n}{f\PYZus{}in}\PY{p}{:}
                 \PY{c+c1}{\PYZsh{} set up csv reader object}
                 \PY{n}{reader} \PY{o}{=} \PY{n}{csv}\PY{o}{.}\PY{n}{DictReader}\PY{p}{(}\PY{n}{f\PYZus{}in}\PY{p}{)}
                 \PY{n}{result} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
                 \PY{n}{result}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{n\PYZus{}week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{*} \PY{l+m+mi}{7}
                 \PY{n}{result}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{d\PYZus{}week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{*} \PY{l+m+mi}{7}
                 \PY{n}{result}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cus\PYZus{}hour}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{*} \PY{l+m+mi}{24}
                 \PY{n}{result}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sub\PYZus{}hour}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{*} \PY{l+m+mi}{24}
                 \PY{k}{for} \PY{n}{data} \PY{o+ow}{in} \PY{n}{reader}\PY{p}{:}
                     \PY{n}{duration} \PY{o}{=} \PY{n+nb}{float}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
                     \PY{k}{if} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{day\PYZus{}of\PYZus{}week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sunday}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
                         \PY{n}{result}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{n\PYZus{}week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                         \PY{n}{result}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{d\PYZus{}week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{+}\PY{o}{=} \PY{n}{duration}
                     \PY{k}{elif} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{day\PYZus{}of\PYZus{}week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Monday}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
                         \PY{n}{result}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{n\PYZus{}week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                         \PY{n}{result}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{d\PYZus{}week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{+}\PY{o}{=} \PY{n}{duration}
                     \PY{k}{elif} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{day\PYZus{}of\PYZus{}week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Tuesday}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
                         \PY{n}{result}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{n\PYZus{}week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                         \PY{n}{result}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{d\PYZus{}week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]} \PY{o}{+}\PY{o}{=} \PY{n}{duration}
                     \PY{k}{elif} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{day\PYZus{}of\PYZus{}week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Wednesday}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
                         \PY{n}{result}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{n\PYZus{}week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                         \PY{n}{result}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{d\PYZus{}week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]} \PY{o}{+}\PY{o}{=} \PY{n}{duration}
                     \PY{k}{elif} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{day\PYZus{}of\PYZus{}week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Thursday}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
                         \PY{n}{result}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{n\PYZus{}week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{4}\PY{p}{]} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                         \PY{n}{result}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{d\PYZus{}week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{4}\PY{p}{]} \PY{o}{+}\PY{o}{=} \PY{n}{duration}
                     \PY{k}{elif} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{day\PYZus{}of\PYZus{}week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Friday}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
                         \PY{n}{result}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{n\PYZus{}week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{5}\PY{p}{]} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                         \PY{n}{result}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{d\PYZus{}week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{5}\PY{p}{]} \PY{o}{+}\PY{o}{=} \PY{n}{duration}
                     \PY{k}{else}\PY{p}{:}
                         \PY{n}{result}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{n\PYZus{}week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{6}\PY{p}{]} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                         \PY{n}{result}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{d\PYZus{}week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{6}\PY{p}{]} \PY{o}{+}\PY{o}{=} \PY{n}{duration}
                         
                     \PY{n}{hour} \PY{o}{=} \PY{n+nb}{int}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{hour}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
                     \PY{k}{if} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{user\PYZus{}type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Customer}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
                         \PY{n}{result}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cus\PYZus{}hour}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{hour}\PY{p}{]} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                     \PY{k}{else}\PY{p}{:}
                         \PY{n}{result}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sub\PYZus{}hour}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{hour}\PY{p}{]} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                 \PY{k}{return} \PY{n}{result}
         
             
         \PY{k}{def} \PY{n+nf}{plot\PYZus{}data\PYZus{}by\PYZus{}day}\PY{p}{(}\PY{n}{data}\PY{p}{)}\PY{p}{:}
             \PY{n}{index} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{7}\PY{p}{)}
             \PY{n}{width} \PY{o}{=} \PY{l+m+mf}{0.3}
         
             \PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{p}{)}
             \PY{n}{host} \PY{o}{=} \PY{n}{fig}\PY{o}{.}\PY{n}{add\PYZus{}subplot}\PY{p}{(}\PY{l+m+mi}{111}\PY{p}{)}
             \PY{n}{part} \PY{o}{=} \PY{n}{host}\PY{o}{.}\PY{n}{twinx}\PY{p}{(}\PY{p}{)}
         
             \PY{n}{host}\PY{o}{.}\PY{n}{set\PYZus{}ylim}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{50000}\PY{p}{)}
             \PY{n}{part}\PY{o}{.}\PY{n}{set\PYZus{}ylim}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{700000}\PY{p}{)}
             \PY{n}{host}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Day of Week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{host}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Numbers}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{part}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Durations(min)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
             \PY{n}{p1} \PY{o}{=} \PY{n}{host}\PY{o}{.}\PY{n}{bar}\PY{p}{(}\PY{n}{index} \PY{o}{+} \PY{l+m+mf}{0.1}\PY{p}{,} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{n\PYZus{}week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{width}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{b}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{p2} \PY{o}{=} \PY{n}{part}\PY{o}{.}\PY{n}{bar}\PY{p}{(}\PY{n}{index} \PY{o}{+} \PY{l+m+mf}{0.4}\PY{p}{,} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{d\PYZus{}week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{width}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{g}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             
             \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{(}\PY{n}{p1}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{p2}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Numbers}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Durations}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,} \PY{n}{prop}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{size}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{8}\PY{p}{\PYZcb{}}\PY{p}{)}
             \PY{n}{host}\PY{o}{.}\PY{n}{yaxis}\PY{o}{.}\PY{n}{label}\PY{o}{.}\PY{n}{set\PYZus{}color}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{b}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{part}\PY{o}{.}\PY{n}{yaxis}\PY{o}{.}\PY{n}{label}\PY{o}{.}\PY{n}{set\PYZus{}color}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{g}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{xticks}\PY{p}{(}\PY{n}{index} \PY{o}{+} \PY{l+m+mf}{0.25}\PY{p}{,} \PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sun}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mon}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Tue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Wed}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Thu}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Fri}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
             
         
         \PY{k}{def} \PY{n+nf}{plot\PYZus{}data\PYZus{}by\PYZus{}hour}\PY{p}{(}\PY{n}{data}\PY{p}{)}\PY{p}{:}
             \PY{n}{index} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{24}\PY{p}{)}
             \PY{n}{p1} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{index}\PY{p}{,} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cus\PYZus{}hour}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bo}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{index}\PY{p}{,} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cus\PYZus{}hour}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{green}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{p2} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{index}\PY{p}{,} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sub\PYZus{}hour}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bo}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{index}\PY{p}{,} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sub\PYZus{}hour}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{blue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{(}\PY{n}{p1}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{p2}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Customer}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Subscribe}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{hour}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{24}\PY{p}{]}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{numbers}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{ticks} \PY{o}{=} \PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{*} \PY{l+m+mi}{24}
             \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{index}\PY{p}{:}
                 \PY{n}{ticks}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{=} \PY{n+nb}{str}\PY{p}{(}\PY{n}{i}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{xticks}\PY{p}{(}\PY{n}{index}\PY{p}{,} \PY{n}{ticks}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)} 
             
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}23}]:} \PY{n}{daily\PYZus{}data} \PY{o}{=} \PY{n}{get\PYZus{}data\PYZus{}by\PYZus{}time}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{./data/NYC\PYZhy{}2016\PYZhy{}Summary.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plot\PYZus{}data\PYZus{}by\PYZus{}day}\PY{p}{(}\PY{n}{daily\PYZus{}data}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{p}{)}
         \PY{n}{plot\PYZus{}data\PYZus{}by\PYZus{}hour}\PY{p}{(}\PY{n}{daily\PYZus{}data}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_28_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]


    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_28_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}24}]:} \PY{k+kn}{import} \PY{n+nn}{networkx} \PY{k}{as} \PY{n+nn}{nx}
         
         \PY{k}{def} \PY{n+nf}{get\PYZus{}station\PYZus{}name}\PY{p}{(}\PY{n}{station\PYZus{}graph}\PY{p}{,} \PY{n}{station}\PY{p}{)}\PY{p}{:}
             \PY{n}{station\PYZus{}name\PYZus{}graph} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{k}{for} \PY{n}{graph} \PY{o+ow}{in} \PY{n}{station\PYZus{}graph}\PY{p}{:}
                 \PY{n+nb}{id} \PY{o}{=} \PY{n}{graph}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
                 \PY{n}{station\PYZus{}name\PYZus{}graph}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{(}\PY{p}{(}\PY{n}{station}\PY{p}{[}\PY{n}{graph}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{]}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s2}{(}\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s2}{)}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{station}\PY{p}{[}\PY{n+nb}{id}\PY{p}{]}\PY{p}{,} \PY{n+nb}{id}\PY{p}{)}\PY{p}{)}\PY{p}{,} \PY{n}{graph}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{p}{)}
             \PY{k}{return} \PY{n}{station\PYZus{}name\PYZus{}graph}
         
         \PY{k}{def} \PY{n+nf}{get\PYZus{}station\PYZus{}graph}\PY{p}{(}\PY{n}{start\PYZus{}station\PYZus{}id}\PY{p}{,} \PY{n}{end\PYZus{}station\PYZus{}list}\PY{p}{)}\PY{p}{:}
             \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
         \PY{l+s+sd}{    return a set from start station to first ten end station }
         \PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}
             \PY{n}{start\PYZus{}station\PYZus{}graph} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{:}
                 \PY{k}{if} \PY{n}{end\PYZus{}station\PYZus{}list}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o+ow}{is} \PY{o+ow}{not} \PY{k+kc}{None}\PY{p}{:}
                     \PY{n}{start\PYZus{}station\PYZus{}graph}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{(}\PY{n}{start\PYZus{}station\PYZus{}id}\PY{p}{,} \PY{n}{end\PYZus{}station\PYZus{}list}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}\PY{p}{)}
             \PY{k}{return} \PY{n}{start\PYZus{}station\PYZus{}graph}
         
         \PY{k}{def} \PY{n+nf}{sort\PYZus{}end\PYZus{}station\PYZus{}list}\PY{p}{(}\PY{n}{start\PYZus{}station\PYZus{}route}\PY{p}{)}\PY{p}{:}
             \PY{n}{end\PYZus{}station\PYZus{}list} \PY{o}{=} \PY{n+nb}{sorted}\PY{p}{(}\PY{n}{start\PYZus{}station\PYZus{}route}\PY{o}{.}\PY{n}{items}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{key}\PY{o}{=}\PY{k}{lambda} \PY{n}{d}\PY{p}{:} \PY{n}{d}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{reverse}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
             \PY{k}{return} \PY{n}{end\PYZus{}station\PYZus{}list}
         
         \PY{k}{def} \PY{n+nf}{get\PYZus{}three\PYZus{}largest\PYZus{}stations\PYZus{}graph}\PY{p}{(}\PY{n}{filename}\PY{p}{)}\PY{p}{:}
             \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
         \PY{l+s+sd}{    find the three largest stations with the most connection with others and find the destinations for them.}
         \PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}
             \PY{k}{with} \PY{n+nb}{open}\PY{p}{(}\PY{n}{filename}\PY{p}{)} \PY{k}{as} \PY{n}{f\PYZus{}in}\PY{p}{:}
                 \PY{n}{reader} \PY{o}{=} \PY{n}{csv}\PY{o}{.}\PY{n}{DictReader}\PY{p}{(}\PY{n}{f\PYZus{}in}\PY{p}{)}
                 \PY{n}{station} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}                \PY{c+c1}{\PYZsh{} This is a \PYZob{}station\PYZhy{}id: station\PYZhy{}name\PYZcb{} dictionary. It is more efficient by using id.}
                 \PY{n}{start\PYZus{}station\PYZus{}number} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}   \PY{c+c1}{\PYZsh{} This is a \PYZob{}station\PYZhy{}id: number of connections\PYZcb{} dictionary.}
                 \PY{n}{start\PYZus{}station\PYZus{}route} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}    \PY{c+c1}{\PYZsh{} This is a \PYZob{}start\PYZhy{}id: \PYZob{}end\PYZus{}id: number of connections\PYZcb{}\PYZcb{} dictionary.}
         
         
                 \PY{n}{largest\PYZus{}station\PYZus{}id} \PY{o}{=} \PY{l+m+mi}{0}
                 \PY{n}{largest\PYZus{}station\PYZus{}times} \PY{o}{=} \PY{l+m+mi}{0}
                 \PY{n}{second\PYZus{}largest\PYZus{}station\PYZus{}id} \PY{o}{=} \PY{l+m+mi}{0}
                 \PY{n}{second\PYZus{}largest\PYZus{}station\PYZus{}times} \PY{o}{=} \PY{l+m+mi}{0}
                 \PY{n}{third\PYZus{}largest\PYZus{}station\PYZus{}id} \PY{o}{=} \PY{l+m+mi}{0}
                 \PY{n}{third\PYZus{}largest\PYZus{}station\PYZus{}times} \PY{o}{=} \PY{l+m+mi}{0}
                 \PY{k}{for} \PY{n}{row} \PY{o+ow}{in} \PY{n}{reader}\PY{p}{:}
                     \PY{n}{start\PYZus{}id} \PY{o}{=} \PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{start station id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
                     \PY{n}{end\PYZus{}id} \PY{o}{=} \PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{end station id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
                     \PY{k}{if} \PY{n}{station}\PY{o}{.}\PY{n}{get}\PY{p}{(}\PY{n}{start\PYZus{}id}\PY{p}{)} \PY{o}{==} \PY{k+kc}{None}\PY{p}{:}
                         \PY{n}{station}\PY{p}{[}\PY{n}{start\PYZus{}id}\PY{p}{]} \PY{o}{=} \PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{start station name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
                     \PY{k}{if} \PY{n}{station}\PY{o}{.}\PY{n}{get}\PY{p}{(}\PY{n}{end\PYZus{}id}\PY{p}{)} \PY{o}{==} \PY{k+kc}{None}\PY{p}{:}
                         \PY{n}{station}\PY{p}{[}\PY{n}{end\PYZus{}id}\PY{p}{]} \PY{o}{=} \PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{start station name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
                     \PY{k}{if} \PY{n}{start\PYZus{}station\PYZus{}route}\PY{o}{.}\PY{n}{get}\PY{p}{(}\PY{n}{start\PYZus{}id}\PY{p}{)} \PY{o}{==} \PY{k+kc}{None}\PY{p}{:}
                         \PY{n}{start\PYZus{}station\PYZus{}route}\PY{p}{[}\PY{n}{start\PYZus{}id}\PY{p}{]} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
                         \PY{n}{start\PYZus{}station\PYZus{}route}\PY{p}{[}\PY{n}{start\PYZus{}id}\PY{p}{]}\PY{p}{[}\PY{n}{end\PYZus{}id}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{1}
                         \PY{n}{start\PYZus{}station\PYZus{}number}\PY{p}{[}\PY{n}{start\PYZus{}id}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{1}
                     \PY{k}{else}\PY{p}{:}
                         \PY{n}{start\PYZus{}station\PYZus{}number}\PY{p}{[}\PY{n}{start\PYZus{}id}\PY{p}{]} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                         \PY{k}{if} \PY{n}{start\PYZus{}station\PYZus{}route}\PY{p}{[}\PY{n}{start\PYZus{}id}\PY{p}{]}\PY{o}{.}\PY{n}{get}\PY{p}{(}\PY{n}{end\PYZus{}id}\PY{p}{)} \PY{o}{==} \PY{k+kc}{None}\PY{p}{:}
                             \PY{n}{start\PYZus{}station\PYZus{}route}\PY{p}{[}\PY{n}{start\PYZus{}id}\PY{p}{]}\PY{p}{[}\PY{n}{end\PYZus{}id}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{1}
                         \PY{k}{else}\PY{p}{:}
                             \PY{n}{start\PYZus{}station\PYZus{}route}\PY{p}{[}\PY{n}{start\PYZus{}id}\PY{p}{]}\PY{p}{[}\PY{n}{end\PYZus{}id}\PY{p}{]} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
         
                     \PY{n}{times} \PY{o}{=} \PY{n}{start\PYZus{}station\PYZus{}number}\PY{p}{[}\PY{n}{start\PYZus{}id}\PY{p}{]}
                     \PY{k}{if} \PY{n}{times} \PY{o}{\PYZgt{}} \PY{n}{third\PYZus{}largest\PYZus{}station\PYZus{}times}\PY{p}{:}
                         \PY{k}{if} \PY{n}{times} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{n}{second\PYZus{}largest\PYZus{}station\PYZus{}times}\PY{p}{:}
                             \PY{k}{if} \PY{n}{times} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{n}{largest\PYZus{}station\PYZus{}times}\PY{p}{:}
                                 \PY{c+c1}{\PYZsh{} If this one is the largest one, only adding the largest by one}
                                 \PY{k}{if} \PY{n}{start\PYZus{}id} \PY{o}{!=} \PY{n}{largest\PYZus{}station\PYZus{}id}\PY{p}{:}
                                     \PY{n}{third\PYZus{}largest\PYZus{}station\PYZus{}id} \PY{o}{=} \PY{n}{second\PYZus{}largest\PYZus{}station\PYZus{}id}
                                     \PY{n}{third\PYZus{}largest\PYZus{}station\PYZus{}times} \PY{o}{=} \PY{n}{second\PYZus{}largest\PYZus{}station\PYZus{}times}
                                     \PY{n}{second\PYZus{}largest\PYZus{}station\PYZus{}id} \PY{o}{=} \PY{n}{largest\PYZus{}station\PYZus{}id}
                                     \PY{n}{second\PYZus{}largest\PYZus{}station\PYZus{}times} \PY{o}{=} \PY{n}{largest\PYZus{}station\PYZus{}times}
                                     \PY{n}{largest\PYZus{}station\PYZus{}id} \PY{o}{=} \PY{n}{start\PYZus{}id}
                                 \PY{n}{largest\PYZus{}station\PYZus{}times} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                             \PY{k}{else}\PY{p}{:}
                                 \PY{c+c1}{\PYZsh{} If this one is the second largest one, only adding the second largest by one}
                                 \PY{k}{if} \PY{n}{start\PYZus{}id} \PY{o}{!=} \PY{n}{second\PYZus{}largest\PYZus{}station\PYZus{}id}\PY{p}{:}
                                     \PY{n}{third\PYZus{}largest\PYZus{}station\PYZus{}id} \PY{o}{=} \PY{n}{second\PYZus{}largest\PYZus{}station\PYZus{}id}
                                     \PY{n}{third\PYZus{}largest\PYZus{}station\PYZus{}times} \PY{o}{=} \PY{n}{second\PYZus{}largest\PYZus{}station\PYZus{}times}
                                     \PY{n}{second\PYZus{}largest\PYZus{}station\PYZus{}id} \PY{o}{=} \PY{n}{start\PYZus{}id}
                                 \PY{n}{second\PYZus{}largest\PYZus{}station\PYZus{}times} \PY{o}{=} \PY{n}{times}
                         \PY{k}{else}\PY{p}{:}
                             \PY{n}{third\PYZus{}largest\PYZus{}station\PYZus{}id} \PY{o}{=} \PY{n}{start\PYZus{}id}
                             \PY{n}{third\PYZus{}largest\PYZus{}station\PYZus{}times} \PY{o}{=} \PY{n}{times}
         
             \PY{c+c1}{\PYZsh{}print the largest three stations information                        }
             \PY{n}{largest\PYZus{}station} \PY{o}{=} \PY{n}{station}\PY{p}{[}\PY{n}{largest\PYZus{}station\PYZus{}id}\PY{p}{]}
             \PY{n}{second\PYZus{}largest\PYZus{}station} \PY{o}{=} \PY{n}{station}\PY{p}{[}\PY{n}{second\PYZus{}largest\PYZus{}station\PYZus{}id}\PY{p}{]}
             \PY{n}{third\PYZus{}largest\PYZus{}station} \PY{o}{=} \PY{n}{station}\PY{p}{[}\PY{n}{third\PYZus{}largest\PYZus{}station\PYZus{}id}\PY{p}{]}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{The largest three stations in NYC are }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s2}{, }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s2}{, and }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                   \PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{largest\PYZus{}station}\PY{p}{,} \PY{n}{second\PYZus{}largest\PYZus{}station}\PY{p}{,} \PY{n}{third\PYZus{}largest\PYZus{}station}\PY{p}{)}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s2}{ has }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s2}{ connections with }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s2}{ stations.}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}
                   \PY{n+nb}{format}\PY{p}{(}\PY{n}{largest\PYZus{}station}\PY{p}{,} \PY{n}{largest\PYZus{}station\PYZus{}times}\PY{p}{,} \PY{n+nb}{len}\PY{p}{(}\PY{n}{start\PYZus{}station\PYZus{}route}\PY{p}{[}\PY{n}{largest\PYZus{}station\PYZus{}id}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s2}{ has }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s2}{ connections with }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s2}{ stations.}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}
                   \PY{n+nb}{format}\PY{p}{(}\PY{n}{second\PYZus{}largest\PYZus{}station}\PY{p}{,} \PY{n}{second\PYZus{}largest\PYZus{}station\PYZus{}times}\PY{p}{,} \PY{n+nb}{len}\PY{p}{(}\PY{n}{start\PYZus{}station\PYZus{}route}\PY{p}{[}\PY{n}{second\PYZus{}largest\PYZus{}station\PYZus{}id}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s2}{ has }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s2}{ connections with }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s2}{ stations.}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}
                   \PY{n+nb}{format}\PY{p}{(}\PY{n}{third\PYZus{}largest\PYZus{}station}\PY{p}{,} \PY{n}{third\PYZus{}largest\PYZus{}station\PYZus{}times}\PY{p}{,} \PY{n+nb}{len}\PY{p}{(}\PY{n}{start\PYZus{}station\PYZus{}route}\PY{p}{[}\PY{n}{third\PYZus{}largest\PYZus{}station\PYZus{}id}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{p}{)}
                             
             \PY{c+c1}{\PYZsh{} sort the station\PYZus{}route by numbers of connections and get the first ten start\PYZhy{}end connections                    }
             \PY{n}{largest\PYZus{}station\PYZus{}graph} \PY{o}{=} \PY{n}{get\PYZus{}station\PYZus{}graph}\PY{p}{(}\PY{n}{largest\PYZus{}station\PYZus{}id}\PY{p}{,} \PY{n}{sort\PYZus{}end\PYZus{}station\PYZus{}list}\PY{p}{(}\PY{n}{start\PYZus{}station\PYZus{}route}\PY{p}{[}\PY{n}{largest\PYZus{}station\PYZus{}id}\PY{p}{]}\PY{p}{)}\PY{p}{)}
             \PY{n}{second\PYZus{}largest\PYZus{}station\PYZus{}graph} \PY{o}{=} \PY{n}{get\PYZus{}station\PYZus{}graph}\PY{p}{(}\PY{n}{second\PYZus{}largest\PYZus{}station\PYZus{}id}\PY{p}{,} \PY{n}{sort\PYZus{}end\PYZus{}station\PYZus{}list}\PY{p}{(}\PY{n}{start\PYZus{}station\PYZus{}route}\PY{p}{[}\PY{n}{second\PYZus{}largest\PYZus{}station\PYZus{}id}\PY{p}{]}\PY{p}{)}\PY{p}{)}
             \PY{n}{third\PYZus{}largest\PYZus{}station\PYZus{}graph} \PY{o}{=} \PY{n}{get\PYZus{}station\PYZus{}graph}\PY{p}{(}\PY{n}{third\PYZus{}largest\PYZus{}station\PYZus{}id}\PY{p}{,} \PY{n}{sort\PYZus{}end\PYZus{}station\PYZus{}list}\PY{p}{(}\PY{n}{start\PYZus{}station\PYZus{}route}\PY{p}{[}\PY{n}{third\PYZus{}largest\PYZus{}station\PYZus{}id}\PY{p}{]}\PY{p}{)}\PY{p}{)}
         
             \PY{c+c1}{\PYZsh{} convert the station\PYZhy{}id back to station\PYZhy{}name}
             \PY{n}{largest\PYZus{}station\PYZus{}graph} \PY{o}{=} \PY{n}{get\PYZus{}station\PYZus{}name}\PY{p}{(}\PY{n}{largest\PYZus{}station\PYZus{}graph}\PY{p}{,} \PY{n}{station}\PY{p}{)}
             \PY{n}{second\PYZus{}largest\PYZus{}station\PYZus{}graph} \PY{o}{=} \PY{n}{get\PYZus{}station\PYZus{}name}\PY{p}{(}\PY{n}{second\PYZus{}largest\PYZus{}station\PYZus{}graph}\PY{p}{,} \PY{n}{station}\PY{p}{)}
             \PY{n}{third\PYZus{}largest\PYZus{}station\PYZus{}graph} \PY{o}{=} \PY{n}{get\PYZus{}station\PYZus{}name}\PY{p}{(}\PY{n}{third\PYZus{}largest\PYZus{}station\PYZus{}graph}\PY{p}{,} \PY{n}{station}\PY{p}{)}
             \PY{k}{return} \PY{n}{largest\PYZus{}station\PYZus{}graph}\PY{p}{,} \PY{n}{second\PYZus{}largest\PYZus{}station\PYZus{}graph}\PY{p}{,} \PY{n}{third\PYZus{}largest\PYZus{}station\PYZus{}graph}
         
         
         \PY{k}{def} \PY{n+nf}{plot\PYZus{}graph}\PY{p}{(}\PY{n}{station\PYZus{}graph}\PY{p}{)}\PY{p}{:}
             \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
         \PY{l+s+sd}{    plot the connection between start\PYZhy{}stations and end\PYZhy{}stations by graph}
         \PY{l+s+sd}{    The node is the station name, and the number in edge is the riding times between two stations. The largest is in red.}
         \PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}
             \PY{n}{G} \PY{o}{=} \PY{n}{nx}\PY{o}{.}\PY{n}{DiGraph}\PY{p}{(}\PY{p}{)}
             \PY{n}{edge\PYZus{}labels} \PY{o}{=} \PY{p}{\PYZob{}}\PY{n}{graph}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{:} \PY{n}{graph}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{k}{for} \PY{n}{graph} \PY{o+ow}{in} \PY{n}{station\PYZus{}graph}\PY{p}{\PYZcb{}}
             \PY{n}{node\PYZus{}labels} \PY{o}{=} \PY{p}{\PYZob{}}\PY{n}{graph}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{:} \PY{n}{graph}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{k}{for} \PY{n}{graph} \PY{o+ow}{in} \PY{n}{station\PYZus{}graph}\PY{p}{\PYZcb{}}
             \PY{k}{for} \PY{n}{graph} \PY{o+ow}{in} \PY{n}{station\PYZus{}graph}\PY{p}{:}
                 \PY{n}{G}\PY{o}{.}\PY{n}{add\PYZus{}edge}\PY{p}{(}\PY{n}{graph}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{graph}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
             \PY{n}{red\PYZus{}edges} \PY{o}{=} \PY{p}{[}\PY{n}{station\PYZus{}graph}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{]}
             \PY{n}{blue\PYZus{}edges} \PY{o}{=} \PY{p}{[}\PY{n}{edge} \PY{k}{for} \PY{n}{edge} \PY{o+ow}{in} \PY{n}{G}\PY{o}{.}\PY{n}{edges}\PY{p}{(}\PY{p}{)} \PY{k}{if} \PY{n}{edge} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{red\PYZus{}edges}\PY{p}{]}
             \PY{n}{pos} \PY{o}{=} \PY{n}{nx}\PY{o}{.}\PY{n}{spring\PYZus{}layout}\PY{p}{(}\PY{n}{G}\PY{p}{)}
             \PY{n}{nx}\PY{o}{.}\PY{n}{draw\PYZus{}networkx\PYZus{}nodes}\PY{p}{(}\PY{n}{G}\PY{p}{,} \PY{n}{pos}\PY{p}{,} \PY{n}{node\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{green}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{node\PYZus{}size}\PY{o}{=}\PY{l+m+mi}{200}\PY{p}{)}
             \PY{n}{nx}\PY{o}{.}\PY{n}{draw\PYZus{}networkx\PYZus{}labels}\PY{p}{(}\PY{n}{G}\PY{p}{,} \PY{n}{pos}\PY{p}{,} \PY{n}{node\PYZus{}labels}\PY{o}{=}\PY{n}{node\PYZus{}labels}\PY{p}{)}
             \PY{n}{nx}\PY{o}{.}\PY{n}{draw\PYZus{}networkx\PYZus{}edges}\PY{p}{(}\PY{n}{G}\PY{p}{,} \PY{n}{pos}\PY{p}{,} \PY{n}{edgelist}\PY{o}{=}\PY{n}{red\PYZus{}edges}\PY{p}{,} \PY{n}{edge\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{arrows}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
             \PY{n}{nx}\PY{o}{.}\PY{n}{draw\PYZus{}networkx\PYZus{}edges}\PY{p}{(}\PY{n}{G}\PY{p}{,} \PY{n}{pos}\PY{p}{,} \PY{n}{edgelist}\PY{o}{=}\PY{n}{blue\PYZus{}edges}\PY{p}{,} \PY{n}{edge\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{b}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{arrows}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
             \PY{n}{nx}\PY{o}{.}\PY{n}{draw\PYZus{}networkx\PYZus{}edge\PYZus{}labels}\PY{p}{(}\PY{n}{G}\PY{p}{,} \PY{n}{pos}\PY{o}{=}\PY{n}{pos}\PY{p}{,} \PY{n}{edge\PYZus{}labels}\PY{o}{=}\PY{n}{edge\PYZus{}labels}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
             
             
         \PY{n}{largest\PYZus{}station\PYZus{}graph}\PY{p}{,} \PY{n}{second\PYZus{}largest\PYZus{}station\PYZus{}graph}\PY{p}{,} \PY{n}{third\PYZus{}largest\PYZus{}station\PYZus{}graph} \PY{o}{=} \PYZbs{}
                 \PY{n}{get\PYZus{}three\PYZus{}largest\PYZus{}stations\PYZus{}graph}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{./data/NYC\PYZhy{}CitiBike\PYZhy{}2016.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plot\PYZus{}graph}\PY{p}{(}\PY{n}{largest\PYZus{}station\PYZus{}graph}\PY{p}{)}
         \PY{n}{plot\PYZus{}graph}\PY{p}{(}\PY{n}{second\PYZus{}largest\PYZus{}station\PYZus{}graph}\PY{p}{)}
         \PY{n}{plot\PYZus{}graph}\PY{p}{(}\PY{n}{third\PYZus{}largest\PYZus{}station\PYZus{}graph}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
The largest three stations in NYC are Avenue D \& E 3 St, E 30 St \& Park Ave S, and W 21 St \& 6 Ave.
Avenue D \& E 3 St has 2969 connections with 352 stations.
E 30 St \& Park Ave S has 2085 connections with 323 stations.
W 21 St \& 6 Ave has 1991 connections with 275 stations.

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_29_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_29_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_29_3.png}
    \end{center}
    { \hspace*{\fill} \\}
    
     \#\# 结论

恭喜你完成了本项目！这只是数据分析流程的一个样本，囊括了提出问题、整理数据、探索数据三大步骤。通常来讲，数据分析流程进行到这一步，你就可以进行统计检验或为数据拟合模型、得出预测，从而得出结论了。虽然还有许多潜在分析可以进行，但仅靠我们提供的这些数据是不可能完成的。例如，我们没有研究具体的地点数据。最常用的停车点在哪里？最常用的路线是什么？再如，天气也可能对每日骑客量造成很大的影响。下雨或下雪的时候，骑客量会受多大的影响？会员或散客谁更易受天气的影响？

\textbf{问题
7}：撇开共享单车数据不谈，想出一个你想应用数据科学技术的课题或领域。对于该课题，你想了解些什么？

\textbf{答案}：我想研究不同的专业对人的性格和长相之间的影响。比如理科生和文科生的性格一般会有差异，学物理的和学文学、学英语的人性格和气质就可能不一样。当然，这个影响因素可能会有很多，甚至就没有关系和影响。这里只是侧重于专业的分析。

\begin{quote}
\textbf{小贴士}：如果我们想同他人分享分析成果，我们也不一定要给他们一份
jupyter Notebook (.ipynb) 文件的副本，我们可以将 Notebook
的输出结果以某种格式输出，这样一来，就算是没有安装 Python
的人也可以打开文件。在左上方的 \textbf{文件} 菜单中找到 \textbf{下载为}
子菜单，你可以在其中选择各种更加普遍的格式，比如 HTML (.html) 或 PDF
(.pdf)。你可能还需要额外的包或软件来实现这类输出。
\end{quote}

\begin{quote}
如果你是通过教室的 Project Notebook
页面来进行本项目的，你也可以直接从工作空间提交本项目。
\textbf{但在此之前}，你得执行下方的代码框，为完成好的项目保存一份 HTML
的副本，并将其放到工作空间中。如果操作顺利，输出代码应为 0，
如果你点击左上角的 jupyter 图标，你就会看到工作空间的目录中出现了你的
.html 文件；或者你也可以根据上述段落提及的步骤来下载报告的 .html
格式副本，然后 \emph{上传} 该报告到目录之中（点击 jupyter
图标来实现这一步）。
\end{quote}

\begin{quote}
无论是哪个办法，一旦你在工作空间中获取了 .html
格式的报告，你就可以点击工作空间右下方的``项目提交''按钮来完成提交。
\end{quote}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}25}]:} \PY{k+kn}{from} \PY{n+nn}{subprocess} \PY{k}{import} \PY{n}{call}
         \PY{n}{call}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{python}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}m}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{nbconvert}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Bike\PYZus{}Share\PYZus{}Analysis.ipynb}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}25}]:} 0
\end{Verbatim}
            

    % Add a bibliography block to the postdoc
    
    
    
    \end{document}
